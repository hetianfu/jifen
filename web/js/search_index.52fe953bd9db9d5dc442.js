(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{"429":function(e,t,n){"use strict";n.d(t,"a",(function(){return setNavigationBarTitle}));var o=n(0);function setNavigationBarTitle(e){var t=Object(o.m)(e);if(!t.res){var n={"errMsg":"setNavigationBarTitle"+t.msg};return console.error(n.errMsg),Promise.reject(n)}var a=e.title,r=e.success,i=e.fail,c=e.complete,l={"errMsg":"setNavigationBarTitle:ok"};return a&&"string"==typeof a?(document.title!==a&&(document.title=a),"function"==typeof r&&r(l),"function"==typeof c&&c(l),Promise.resolve(l)):(l.errMsg=Object(o.e)({"name":"setNavigationBarTitle","para":"title","correct":"String","wrong":a}),console.error(l.errMsg),"function"==typeof i&&i(l),"function"==typeof c&&c(l),Promise.reject(l))}},"543":function(e,t,n){},"622":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return v}));var o=n(1),a=n(429),r=n(128),i=n(3),c=n(43),l=n(485),s=n(12),u=n.n(s),p=(n(543),n(2)),d=n(312),m=n(306),f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},y=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}(),h=function get(e,t,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,t);if(void 0===o){var a=Object.getPrototypeOf(e);return null===a?void 0:get(a,t,n)}if("value"in o)return o.value;var r=o.get;return void 0!==r?r.call(n):void 0};function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var v=function(e){function Index(){_classCallCheck(this,Index);var e=_possibleConstructorReturn(this,(Index.__proto__||Object.getPrototypeOf(Index)).apply(this,arguments));e.config={"backgroundTextStyle":"dark","navigationBarTitleText":"商品列表"};var t=e.$router.params,n=t.name?decodeURI(t.name):"";return t.cName&&Object(a.a)({"title":t.cName}),e.state={"params":t,"loading":!0,"type":0,"typeList":[{"title":"价格","name":"sale_price","type":"sorter"},{"title":"销量","name":"sales_number","type":"sorter"},{"title":"推荐","name":"isHot","type":"hot"}],"page":1,"limit":10,"dataList":[],"loadStatus":"loading","searchInput":n},e}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{"constructor":{"value":e,"enumerable":!1,"writable":!0,"configurable":!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(Index,e),y(Index,[{"key":"componentDidMount","value":function componentDidMount(){this.getGoodsPage()}},{"key":"onReachBottom","value":function onReachBottom(){this.getGoodsPage()}},{"key":"onSwitchType","value":function onSwitchType(e){this.setState({"type":e})}},{"key":"onInput","value":function onInput(e){this.setState({"searchInput":e.detail.value})}},{"key":"onConfirmSearch","value":function onConfirmSearch(){var e=this;this.setState({"page":1,"loadStatus":"loading"},(function(){e.getGoodsPage()}))}},{"key":"onClickType","value":function onClickType(e,t){var n=this,o=this.state.typeList;"sorter"===e.type?(e.value=function getSorter(e){return"asc"===e.value?"desc":"desc"===e.value?null:(e.value,"asc")}(e),o[t]=e):"hot"===e.type&&(e.value=!e.value,o[t]=e),o.map((function(t){"sorter"===t.type&&"sorter"===e.type&&t.value&&(t.value=e.name===t.name?t.value:null)})),this.setState({"page":1,"typeList":o,"loadStatus":"loading"},(function(){n.getGoodsPage()}))}},{"key":"getGoodsPage","value":function getGoodsPage(){var e=this,t=this.state,n=t.page,o=t.limit,a=t.params,r=t.typeList,i=t.searchInput,c=t.dataList,l=t.loadStatus,s={};"noMore"!==l&&(i&&(s.name=i),a.cId&&(s.categoryId=a.cId),r.map((function(e){"sorter"===e.type&&e.value?s.orders=function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{"value":n,"enumerable":!0,"configurable":!0,"writable":!0}):e[t]=n,e}({},e.name,e.value):"hot"===e.type&&e.value&&(s[e.name]=Number(e.value))})),Object(d.b)(f({"page":n,"limit":o},s)).then((function(t){var a=t.data,r=a.list,i=a.totalCount;e.setState({"page":n+1,"dataList":1===n?r:c.concat(r),"loadStatus":n*o>=i?"noMore":"loading"},(function(){e.setState({"loading":!1})}))})))}},{"key":"render","value":function render(){var e=this,t=this.state,n=t.loading,a=t.type,r=t.typeList,i=t.searchInput,s=t.dataList,d=t.loadStatus;return o.l.createElement(c.a,{"className":"search"},n&&o.l.createElement(m.J,null),o.l.createElement(c.a,{"className":"search-scroll"},o.l.createElement(c.a,{"className":"index-head"},o.l.createElement(c.a,{"className":"search-box d-f a-i-c"},o.l.createElement(c.a,{"className":"input-box d-f a-i-c"},o.l.createElement(c.a,{"className":"bnn-icon search-icon"},""),o.l.createElement(l.a,{"value":i,"className":"search-input","confirmType":"search","placeholder":"点击搜索商品信息","placeholderClass":"placeholder-input","onInput":this.onInput.bind(this),"onConfirm":this.onConfirmSearch.bind(this)})),o.l.createElement(c.a,{"className":"type-box"},1===a&&o.l.createElement(c.a,{"className":"bnn-icon type-icon","onClick":this.onSwitchType.bind(this,0)},""),0===a&&o.l.createElement(c.a,{"className":"bnn-icon type-icon","onClick":this.onSwitchType.bind(this,1)},""))),o.l.createElement(c.a,{"className":"type-list d-f thin-border__b"},r.map((function(t,n){return o.l.createElement(c.a,{"key":n,"className":"type-item","onClick":e.onClickType.bind(e,t,n)},o.l.createElement(c.a,{"className":u()("type-name",t.value&&"active")},t.title),"sorter"===t.type&&o.l.createElement(c.a,{"className":"column-sorter d-f f-d-c a-i-c"},o.l.createElement(c.a,{"className":u()("bnn-icon sort-icon sorter-up","asc"===t.value&&"active")},""),o.l.createElement(c.a,{"className":u()("bnn-icon sort-icon sorter-down","desc"===t.value&&"active")},"")))})))),!!s.length&&o.l.createElement(c.a,{"className":"index-body"},0===a&&o.l.createElement(m.v,{"list":s}),1===a&&o.l.createElement(m.j,{"list":s})),!Object(p.y)(s,d)&&o.l.createElement(m.I,{"status":d}),Object(p.y)(s,d)&&o.l.createElement(c.a,{"className":"list-empty"},o.l.createElement(m.n,null))))}},{"key":"componentDidShow","value":function componentDidShow(){h(Index.prototype.__proto__||Object.getPrototypeOf(Index.prototype),"componentDidShow",this)&&h(Index.prototype.__proto__||Object.getPrototypeOf(Index.prototype),"componentDidShow",this).call(this),this._offReachBottom=Object(r.a)({"callback":this.onReachBottom,"ctx":this,"onReachBottomDistance":void 0})}},{"key":"componentDidHide","value":function componentDidHide(){h(Index.prototype.__proto__||Object.getPrototypeOf(Index.prototype),"componentDidHide",this)&&h(Index.prototype.__proto__||Object.getPrototypeOf(Index.prototype),"componentDidHide",this).call(this),this._offReachBottom&&this._offReachBottom()}}]),Index}(i.a.Component)}}]);