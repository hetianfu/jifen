(window.webpackJsonp=window.webpackJsonp||[]).push([[57],{"393":function(e,t,o){"use strict";o.d(t,"a",(function(){return a}));var n=o(0),i=void 0,r=void 0,a=function pageScrollTo(e){var t=e.scrollTop,o=e.duration,a=void 0===o?300:o,c=e.success,l=e.fail,s=e.complete;return new Promise((function(e,o){try{if(void 0===t)throw Error('"scrollTop" is required');var u=document.querySelector(".taro-tabbar__panel")||window;i||(i=u===window?function scrollFunc(e){if(void 0===e)return window.pageYOffset;window.scrollTo(0,e)}:function scrollFunc(e){if(void 0===e)return u.scrollTop;u.scrollTop=e});var d=i(),p=t,f=p-d,m=a/17-1,h=Object(n.f)(n.c,m);!function scroll(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,o=d+f*h(t);if(i(o),t<m)r&&clearTimeout(r),r=setTimeout((function(){scroll(t+1)}),17);else{var n={"errMsg":"pageScrollTo:ok"};i(p),c&&c(n),s&&s(n),e(n)}}()}catch(e){var y={"errMsg":"pageScrollTo:fail "+e.message};l&&l(y),s&&s(y),o(y)}}))}},"395":function(e,t,o){"use strict";o.d(t,"a",(function(){return getCategoryList}));var n=o(9);function getCategoryList(){return n.a.get("/categories/get-list")}},"537":function(e,t,o){},"619":function(e,t,o){"use strict";o.r(t),o.d(t,"default",(function(){return _}));var n=o(1),i=o(616),r=o(393),a=o(129),c=o(3),l=o(43),s=o(485),u=o(454),d=o(613),p=(o(537),o(12)),f=o.n(p),m=o(395),h=o(68),y=o(306),g=o(16),v=function(){function defineProperties(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,o){return t&&defineProperties(e.prototype,t),o&&defineProperties(e,o),e}}(),b=function get(e,t,o){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,t);if(void 0===n){var i=Object.getPrototypeOf(e);return null===i?void 0:get(i,t,o)}if("value"in n)return n.value;var r=n.get;return void 0!==r?r.call(o):void 0};function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var _=function(e){function Index(){_classCallCheck(this,Index);var e=_possibleConstructorReturn(this,(Index.__proto__||Object.getPrototypeOf(Index)).apply(this,arguments));return e.config={"backgroundTextStyle":"dark","navigationBarTitleText":"商品分类"},e.state={"loading":!0,"nodeKey":0,"dataList":[],"nodeList":[]},e.scrollTop=-1,e}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{"constructor":{"value":e,"enumerable":!1,"writable":!0,"configurable":!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(Index,e),v(Index,[{"key":"componentDidMount","value":function componentDidMount(){this.getList()}},{"key":"onPageScroll","value":function onPageScroll(e){var t=e.scrollTop,o=this.state,n=o.nodeKey,i=o.nodeList;if(this.scrollTop>=0)t===this.scrollTop&&(this.scrollTop=-1);else{var r=i.filter((function(e){return t>=e.top})).length-1;n!==r&&this.setState({"nodeKey":r})}}},{"key":"getList","value":function getList(){var e=this;Object(m.a)().then((function(t){var o=t.data.filter((function(e){return e.child.length}));e.setState({"dataList":o},(function(){setTimeout((function(){e.getNodeLocation(o)}))}))}))}},{"key":"getNodeLocation","value":function getNodeLocation(e){var t=this,o=0,n=[],r=Object(i.a)();r.select("#page-head").boundingClientRect((function(e){o=e.height})),e.map((function(e,t){r.select("#cty-item-"+t).boundingClientRect((function(e){var i=e.top;n.push({"id":"#cty-item-"+t,"top":i-o})}))})),r.exec((function(){t.setState({"nodeList":n})})),this.setState({"loading":!1})}},{"key":"onSwitchType","value":function onSwitchType(e){var t=this,o=this.state.nodeList[e].top;this.setState({"nodeKey":e},(function(){Object(r.a)({"scrollTop":o,"duration":200}),t.scrollTop=o}))}},{"key":"onConfirmSearch","value":function onConfirmSearch(e){Object(h.A)({"name":e.detail.value})}},{"key":"onClickCategory","value":function onClickCategory(e){Object(h.A)({"cId":e.id,"cName":e.name})}},{"key":"render","value":function render(){var e=this,t=this.state,o=t.loading,i=t.nodeKey,r=t.dataList;return n.l.createElement(l.a,{"className":"category-page xf-page"},o&&n.l.createElement(y.J,null),n.l.createElement(l.a,{"id":"page-head","className":"page-head thin-border__b f-g-5"},n.l.createElement(l.a,{"className":"input-box d-f a-i-c"},n.l.createElement(l.a,{"className":"bnn-icon search-icon"},""),n.l.createElement(s.a,{"className":"search-input","confirmType":"search","placeholder":"点击搜索商品","placeholderClass":"placeholder-input","onConfirm":this.onConfirmSearch.bind(this)}))),n.l.createElement(l.a,{"className":"page-body"},n.l.createElement(u.a,{"scrollY":!0,"className":"body-left cty-list"},r.map((function(t,o){return n.l.createElement(l.a,{"key":t.id,"className":f()("cty-item",{"cty-item__active":i===o}),"onClick":e.onSwitchType.bind(e,o)},t.name)}))),n.l.createElement(l.a,{"className":"body-right","style":{"paddingBottom":g.o+"px"}},r.map((function(t,o){return n.l.createElement(l.a,{"key":o,"className":f()("cty-item",{"cty-item__last":o===r.length-1}),"id":"cty-item-"+o},n.l.createElement(l.a,{"className":"cty-name f-g-5"},t.name),n.l.createElement(l.a,{"className":"child-list d-f f-w-w"},t.child&&t.child.map((function(t){return n.l.createElement(l.a,{"key":t.id,"className":"child-item f-g-5 f-d-c","onClick":e.onClickCategory.bind(e,t)},n.l.createElement(d.a,{"src":t.pic,"className":"child-img"}),n.l.createElement(l.a,{"className":"child-name"},t.name))}))))})))),n.l.createElement(y.U,null))}},{"key":"componentDidShow","value":function componentDidShow(){b(Index.prototype.__proto__||Object.getPrototypeOf(Index.prototype),"componentDidShow",this)&&b(Index.prototype.__proto__||Object.getPrototypeOf(Index.prototype),"componentDidShow",this).call(this),this._offPageScroll=Object(a.a)({"callback":this.onPageScroll,"ctx":this})}},{"key":"componentDidHide","value":function componentDidHide(){b(Index.prototype.__proto__||Object.getPrototypeOf(Index.prototype),"componentDidHide",this)&&b(Index.prototype.__proto__||Object.getPrototypeOf(Index.prototype),"componentDidHide",this).call(this),this._offPageScroll&&this._offPageScroll()}}]),Index}(c.a.Component)}}]);