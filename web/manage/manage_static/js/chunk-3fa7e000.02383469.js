(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3fa7e000"],{1987:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"shop-setting-info"},[a("a-card",[a("a-row",{staticClass:"margin-bottom-16",attrs:{gutter:8}},[a("a-col",{attrs:{md:3,sm:24}},[a("a-input",{attrs:{allowClear:"",placeholder:"秒杀标题"},model:{value:t.queryParam.name,callback:function(e){t.$set(t.queryParam,"name",e)},expression:"queryParam.name"}})],1),a("a-col",{attrs:{md:3,sm:24}},[a("a-select",{staticClass:"width-percent-100",attrs:{allowClear:"",placeholder:"开启状态"},model:{value:t.queryParam.onShow,callback:function(e){t.$set(t.queryParam,"onShow",e)},expression:"queryParam.onShow"}},[a("a-select-option",{attrs:{value:"1"}},[t._v("开启")]),a("a-select-option",{attrs:{value:"0"}},[t._v("关闭")])],1)],1),a("a-col",{attrs:{md:4,sm:24}},[a("span",[a("a-button",{attrs:{type:"primary"},on:{click:function(e){return t.$refs.table.refresh(!0)}}},[t._v("查询")]),a("a-button",{staticClass:"margin-left-8",on:{click:function(){return t.queryParam={}}}},[t._v("重置")])],1)])],1),a("a-button",{staticClass:"margin-bottom-16",attrs:{type:"primary"},on:{click:t.handleAdd}},[a("a-icon",{attrs:{type:"plus"}}),t._v("添加秒杀商品")],1),a("s-table",{ref:"table",attrs:{rowKey:function(t,e){return e},columns:t.columns,data:t.loadData,pagination:t.pagination},scopedSlots:t._u([{key:"productInfo",fn:function(t){return[a("preview",{attrs:{img:t.image,name:t.name}})]}},{key:"originPrice",fn:function(e,a){return[t._v(t._s(t._f("moneyFormat")(a.productInfo.originPrice)))]}},{key:"salePrice",fn:function(e,a){return[t._v(t._s(t._f("moneyFormat")(a.productInfo.salePrice)))]}},{key:"strategyType",fn:function(e,r){return t._l(t.INFO_STRATEGY_TYPE,(function(e,n){return r.strategyType===e.value?a("a-tag",{key:n,attrs:{color:e.color}},[t._v(t._s(e.name))]):t._e()}))}},{key:"status",fn:function(e,r){return[0==r.status?a("a-badge",{attrs:{status:"processing",text:"生效"}}):t._e(),1==r.status?a("a-badge",{attrs:{status:"error",text:"失效"}}):t._e()]}},{key:"isOnSale",fn:function(e){return[a("a-switch",{attrs:{"checked-children":"开启","un-checked-children":"关闭",loading:e.loading,checked:Boolean(e.isOnSale)},on:{change:function(a){return t.onChangeIsOnSale(e,a)}}})]}},{key:"action",fn:function(e,r){return[a("a",{on:{click:function(e){return t.editStrategyHandle(r)}}},[t._v("编辑秒杀")]),a("a-divider",{attrs:{type:"vertical"}}),a("a-dropdown",{attrs:{trigger:["click"]}},[a("a",[t._v("更多 "),a("a-icon",{attrs:{type:"down"}})],1),a("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[a("a-menu-item",{on:{click:function(e){return t.productEdit(r)}}},[a("a",[t._v("编辑商品")])]),a("a-menu-item",{on:{click:function(e){return t.productStockDetail(r)}}},[a("a",[t._v("销售记录")])]),a("a-menu-item",{on:{click:function(e){return t.handleClean(r)}}},[a("a",[t._v("清除分享图")])]),a("a-menu-item",{on:{click:function(e){return t.delStrategyHandle(r)}}},[a("a",{staticClass:"color-red"},[t._v("删除")])])],1)],1)]}},{key:"expandedRowRender",fn:function(e){return a("a-table",{attrs:{rowKey:function(t){return t.id},columns:t.innerColumns,"data-source":e.productInfo.skuList,pagination:!1},scopedSlots:t._u([{key:"i-action",fn:function(e,r){return[a("a",{on:{click:function(e){return t.handleStockDetail(r)}}},[t._v("销售详情")])]}}])})}}])})],1),a("a-modal",{attrs:{title:t.strategy.title,width:"750px"},on:{ok:function(e){"add"===t.strategy.status?t.getHandleAdd():t.getHandleEdit()}},model:{value:t.strategy.visible,callback:function(e){t.$set(t.strategy,"visible",e)},expression:"strategy.visible"}},[a("a-form",{attrs:{form:t.strategy.form,"label-col":{span:4},"wrapper-col":{span:20}}},["add"===t.strategy.status?a("a-form-item",{attrs:{label:"选择商品"}},[a("a",{on:{click:t.addProductHandle}},[t.productName?t._e():a("span",[t._v("点击此选择商品")]),t.productSta?t._e():a("span",[t._v(t._s(t.productName))])])]):t._e(),"edit"===t.strategy.status?a("a-form-item",{staticClass:"display-none",attrs:{label:"Id"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["id"],expression:"['id']"}]})],1):t._e(),a("a-form-item",{attrs:{label:"秒杀标题"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请输入秒杀标题!"}]}],expression:"['name',{ rules: [{ required: true, message: '请输入秒杀标题!' }] }]"}],attrs:{placeholder:"请输入秒杀标题"}})],1),a("a-form-item",{attrs:{label:"活动类型","wrapper-col":{span:7}}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["strategyType",{initialValue:"SECKILL"}],expression:"[ 'strategyType',{ initialValue: 'SECKILL' }]"}],attrs:{placeholder:"请选择活动类型"}},t._l(t.INFO_STRATEGY_TYPE,(function(e,r){return a("a-select-option",{key:r,attrs:{value:e.value}},[t._v(" "+t._s(e.name)+" ")])})),1)],1),a("a-form-item",{attrs:{label:"秒杀日期"}},[a("a-range-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["date",t.config],expression:"['date', config]"}],on:{change:t.onChangePicker}})],1),a("a-form-item",{attrs:{label:"秒杀时间段","label-col":{span:4},"wrapper-col":{span:20}}},[a("a-row",[a("a-col",{staticClass:"height-35",attrs:{span:6}},[a("a-form-item",[a("a-time-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["startHour",{rules:[{required:!0,message:"请选择开始时间!"}]}],expression:"['startHour',{ rules: [{ required: true, message: '请选择开始时间!' }] }]"}],attrs:{format:"HH"},on:{change:function(e,a){return t.changeTime(e,a,"startTime")}}})],1)],1),a("a-col",{staticClass:"height-35",attrs:{span:1}},[t._v("至")]),a("a-col",{staticClass:"height-35",attrs:{span:6}},[a("a-form-item",[a("a-time-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["endHour",{rules:[{required:!0,message:"请选择结束时间!"}]}],expression:"['endHour',{ rules: [{ required: true, message: '请选择结束时间!' }] }]"}],attrs:{format:"HH",disabledHours:t.getDisabledHours},on:{change:function(e,a){return t.changeTime(e,a,"endTime")}}})],1)],1)],1)],1),a("a-form-item",{attrs:{label:"用户限购数量"}},[a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["limitNumber",{initialValue:1}],expression:"['limitNumber', { initialValue: 1 }]"}],attrs:{min:0}})],1),a("a-form-item",{attrs:{label:"排序"}},[a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["showOrder"],expression:"['showOrder']"}],attrs:{min:0,max:1e3,placeholder:"0"}})],1)],1)],1),a("product",{on:{submit:t.handleSub},model:{value:t.productModal,callback:function(e){t.productModal=e},expression:"productModal"}})],1)},n=[],i=(a("d81d"),a("b0c0"),a("a9e3"),a("d3b7"),a("ac1f"),a("1276"),a("5530")),s=a("15fd"),o=a("7154"),c=a("4c79"),d=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"editable-cell"},[t.editable?a("div",{staticClass:"editable-cell-input-wrapper"},[a("a-input",{staticStyle:{"font-size":"12px",width:"60px"},attrs:{value:t.value},on:{change:t.handleChange,pressEnter:t.check}}),a("a-icon",{staticClass:"editable-cell-icon-check",attrs:{type:"check"},on:{click:t.check}})],1):a("div",{staticClass:"editable-cell-text-wrapper"},[a("a-popover",{attrs:{placement:"topLeft",arrowPointAtCenter:""}},[a("template",{slot:"content"},[t._v(t._s(t.value))]),a("span",[t._v(t._s(t._f("textOverflowEllipsis")(t.value,0,10)))])],2),a("a-icon",{staticClass:"editable-cell-icon",attrs:{type:"edit"},on:{click:t.edit}})],1)])},l=[],u={props:{text:{required:!0},scope:{type:Object,required:!0}},data:function(){return{value:this.text,row:this.scope,editable:!1}},watch:{text:function(t){this.value=t},scope:function(t){this.row=t}},methods:{handleChange:function(t){var e=t.target.value;this.value=e},check:function(){this.editable=!1,this.$emit("change",this.value)},edit:function(){this.editable=!0}}},m=u,p=(a("be65"),a("2877")),h=Object(p["a"])(m,d,l,!1,null,"02a5a158",null),f=h.exports,g=a("a59b"),v=a.n(g),b=a("c1df"),y=a.n(b),w=a("2af9"),S=a("f121"),k=a("88bc"),_=a.n(k),H=a("0644"),I=a.n(H),x=a("17eb"),O={components:{Template:x["a"],STable:w["p"],EditName:f,product:w["x"],preview:w["w"]},data:function(){var t=this;return{strategy:{visible:!1,form:null,status:null,title:""},productModal:!1,productData:[],productId:null,productName:null,INFO_STRATEGY_TYPE:S["i"],queryParam:{},selectProductModal:!1,productSta:!0,startDate:null,startTime:null,endTime:null,endHour:null,categoryList:[],skuList:[],config:{rules:[{type:"array"}]},columns:[{title:"编号",dataIndex:"id",width:90},{title:"秒杀商品",scopedSlots:{customRender:"productInfo"},width:200},{title:"原价",scopedSlots:{customRender:"originPrice"},width:100},{title:"秒杀价",scopedSlots:{customRender:"salePrice"},width:130},{title:"开始时间",dataIndex:"startDate",scopedSlots:{customRender:"startDate"},width:160},{title:"结束时间",dataIndex:"endDate",scopedSlots:{customRender:"endDate"},width:160},{title:"限购数量",dataIndex:"limitNumber",width:120},{title:"状态",scopedSlots:{customRender:"isOnSale"},width:120},{title:"排序",dataIndex:"showOrder",width:90},{title:"操作",scopedSlots:{customRender:"action"},width:170}],productList:[{title:"ID",dataIndex:"id",scopedSlots:{customRender:"p-id"},width:200},{title:"商品名称",dataIndex:"name",scopedSlots:{customRender:"p-name"}},{title:"库存数量",dataIndex:"stockNumber",scopedSlots:{customRender:"p-stockNumber"}},{title:"操作",scopedSlots:{customRender:"p-action"}}],innerColumns:[{title:"商品ID",dataIndex:"productId",width:190,ellipsis:!0},{title:"商品规格",dataIndex:"specSnap",scopedSlots:{customRender:"i-specSnap"},ellipsis:!0,width:270},{title:"库存",dataIndex:"stockNumber",width:"8%"},{title:"商品条码",dataIndex:"barCode",ellipsis:!0},{title:"操作",scopedSlots:{customRender:"i-action"},width:100}],pagination:{pageSize:10,current:1},loadData:function(e){var a=e.pageNo,r=e.pageSize,n=t.queryParam,i=n.name,s=n.strategyType,c=n.onShow,d={page:a,limit:r,name:i||void 0,strategyType:s,onShow:c};return Object(o["c"])(d).then((function(t){t.data.list.map((function(t){t.loading=!1,t.isOnSale=t.productInfo.isOnSale,t.image=v()(t.productInfo.images)}));var e=t.data.list;return{pageNo:a,pageSize:r,data:e,totalCount:0}}))}}},methods:{moment:y.a,changeTime:function(t,e,a){"startTime"===a?this.startTime=e:this.endTime=e},getDisabledHours:function(){for(var t=[],e=String(this.startTime),a=e.split(":"),r=0;r<parseInt(a[0]);r++)t.push(r);return t},addProductHandle:function(){this.productModal=!0},handleSub:function(t){this.productId=t.id,this.productName=t.name,this.strategy.form.setFieldsValue({name:this.productName}),""!==t.name?this.productSta=!1:this.productSta=!0},onChangePicker:function(t,e){this.startDate=e[0],this.endDate=e[1]},handleAdd:function(){this.strategy={form:this.$form.createForm(this),status:"add",visible:!0,title:"添加秒杀"},this.productSta=!0,this.productName="",this.productId=""},getHandleAdd:function(){var t=this,e=this.startDate,a=this.endDate,r=this.productId,n=this.$refs.table,c=this.$notification.success;this.strategy.form.validateFields((function(d,l){l.startHour=l.startHour.format("HH"),l.endHour=l.endHour.format("HH");var u=Object(i["a"])(Object(i["a"])({},l),{},{startDate:e,endDate:a,productId:r}),m=(u.date,Object(s["a"])(u,["date"]));d||Object(o["a"])(m).then((function(e){c({message:"成功",description:"添加成功"}),n.refresh(),t.strategy.visible=!1}))}))},editStrategyHandle:function(t){var e=this;this.startTime=t.startHour,this.endTime=t.endHour;var a=I()(t);this.productId=a.id,this.startDate=a.startDate,this.endDate=a.endDate,this.strategy={form:this.$form.createForm(this),status:"edit",visible:!0,title:"编辑 ".concat(a.name)},a.date=[this.startDate,this.endDate],new Promise((function(t){setTimeout(t,0)})).then((function(){a.startHour=y()(a.startHour,"HH"),a.endHour=y()(a.endHour,"HH"),e.strategy.form.setFieldsValue(_()(a,["id","name","strategyType","date","showOrder","startHour","endHour","limitNumber"]))}))},getHandleEdit:function(){var t=this,e=this.$refs.table,a=this.$notification.success,r=this.startDate,n=this.endDate;this.strategy.form.validateFields((function(c,d){if(!c){d.startHour=d.startHour.format("HH"),d.endHour=d.endHour.format("HH");var l=Object(i["a"])(Object(i["a"])({},d),{},{startDate:r,endDate:n}),u=(l.date,Object(s["a"])(l,["date"]));Object(o["d"])(u).then((function(r){a({message:"成功",description:"修改成功"}),e.refresh(!0),t.strategy.visible=!1}))}}))},productEdit:function(t){this.$router.push({name:"StrategyProductEdit",params:{id:t.id}})},onChangeIsOnSale:function(t,e){var a=this;t.loading=!0,t.isOnSale=Number(e);var r={id:t.productInfo.id,isOnSale:t.isOnSale};Object(c["s"])(r).then((function(e){setTimeout((function(){t.loading=!1,a.$message.success("修改成功")}),200)}))},delStrategyHandle:function(t){var e=this.$refs.table,a=this.$notification.success;this.$confirm({title:"警告",content:"是否删除[ ".concat(t.name," ]"),onOk:function(){Object(o["b"])(t.id).then((function(t){a({message:"成功",description:"删除成功"}),e.refresh(!0)}))}})},handleClean:function(t){var e=this.$refs.table,a=this.$notification.success;this.$confirm({title:"警告",content:"是否清除分享图?",onOk:function(){Object(c["d"])(t.productInfo.id).then((function(t){a({message:"成功",description:"清除成功"}),e.refresh()}))}})},productStockDetail:function(t){this.$router.push({name:"ProductStockDetail",params:{productId:t.id}})},handleStockDetail:function(t){this.$router.push({name:"ProductStockDetail",params:{id:t.id}})}}},D=O,T=(a("2d90"),Object(p["a"])(D,r,n,!1,null,"231884ba",null));e["default"]=T.exports},"2d90":function(t,e,a){"use strict";a("3360")},3360:function(t,e,a){},"3ab2":function(t,e,a){},be65:function(t,e,a){"use strict";a("3ab2")}}]);