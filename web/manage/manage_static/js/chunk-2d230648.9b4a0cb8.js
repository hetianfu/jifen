(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d230648"],{eba6:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-card",[a("div",{staticClass:"margin-bottom-16"},[a("a-row",{attrs:{gutter:8}},[a("a-col",{attrs:{md:3,sm:24}},[a("a-select",{staticClass:"width-percent-100",attrs:{allowClear:"",placeholder:"状态"},model:{value:t.queryParam.status,callback:function(e){t.$set(t.queryParam,"status",e)},expression:"queryParam.status"}},[a("a-select-option",{attrs:{value:"1"}},[t._v("正常")]),a("a-select-option",{attrs:{value:"0"}},[t._v("失效")])],1)],1),a("a-col",{attrs:{md:4,sm:24}},[a("a-select",{staticClass:"width-percent-100",attrs:{"show-search":"",allowClear:"",placeholder:"模板名称","option-filter-prop":"children"},model:{value:t.queryParam.templateId,callback:function(e){t.$set(t.queryParam,"templateId",e)},expression:"queryParam.templateId"}},t._l(t.marketTmp,(function(e){return a("a-select-option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.title))])})),1)],1),a("a-col",{attrs:{md:4,sm:24}},[a("a-button",{attrs:{type:"primary"},on:{click:function(e){return t.$refs.table.refresh(!0)}}},[t._v("查询")]),a("a-button",{staticClass:"margin-left-8",on:{click:function(){return t.queryParam={}}}},[t._v("重置")])],1)],1)],1),a("s-table",{ref:"table",attrs:{rowKey:function(t,e){return e},columns:t.columns,data:t.loadData,pagination:t.pagination},scopedSlots:t._u([{key:"number",fn:function(e,n){return[a("div",[t._v("总数："+t._s(n.limitNumber))]),a("div",[t._v("剩余："+t._s(n.leftNumber))])]}},{key:"type",fn:function(e,n){return n.template?t._l(t.COUPON_TEMPLATE_TYPE,(function(e,s){return n.template.type===e.value?a("a-tag",{key:s,attrs:{color:e.color}},[t._v(t._s(e.name))]):t._e()})):void 0}},{key:"time",fn:function(e,n){return[1===n.isPermanent?a("span",[t._v("长期有效")]):a("span",[t._v(t._s(t._f("parseTime")(n.fromtime,"YYYY-MM-DD"))+" - "+t._s(t._f("parseTime")(n.totime,"YYYY-MM-DD")))])]}},{key:"isOnce",fn:function(e,n){return[1===n.isOnce?a("a-tag",[t._v("是")]):a("a-tag",[t._v("否")])]}},{key:"isPaySend",fn:function(e,n){return[1===n.isPaySend?a("a-badge",{attrs:{status:"processing",text:"开启"}}):t._e(),0===n.isPaySend?a("a-badge",{attrs:{status:"default",text:"关闭"}}):t._e()]}},{key:"status",fn:function(e,n){return[a("a-switch",{attrs:{"checked-children":"正常","un-checked-children":"失效",loading:n.loading,checked:Boolean(n.status)},on:{change:function(e){return t.changeHandleStatus(n,e)}}})]}},{key:"action",fn:function(e,n){return[a("a",{staticClass:"color-red",on:{click:function(e){return t.handleDel(n)}}},[t._v("删除")])]}}],null,!0)})],1),a("a-modal",{attrs:{title:"会员列表",width:"800px"},on:{ok:t.getHandleCoupons},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[a("user-list",{on:{change:t.getHandleUserList}})],1)],1)},s=[],o=(a("d81d"),a("a9e3"),a("5530")),r=a("4124"),i=a("f121"),l=a("2af9"),c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"margin-bottom-16"},[a("a-row",{attrs:{gutter:10}},[a("a-col",{attrs:{md:4,sm:24}},[a("a-input",{attrs:{placeholder:"昵称","allow-clear":""},model:{value:t.queryParam.userName,callback:function(e){t.$set(t.queryParam,"userName",e)},expression:"queryParam.userName"}})],1),a("a-col",{attrs:{md:6,sm:24}},[a("a-input",{attrs:{placeholder:"手机号","allow-clear":""},model:{value:t.queryParam.telephone,callback:function(e){t.$set(t.queryParam,"telephone",e)},expression:"queryParam.telephone"}})],1),a("a-col",{attrs:{md:3,sm:24}},[a("a-select",{staticClass:"width-percent-100",attrs:{"show-search":"",placeholder:"身份","option-filter-prop":"children","allow-clear":""},model:{value:t.queryParam.isSalesPerson,callback:function(e){t.$set(t.queryParam,"isSalesPerson",e)},expression:"queryParam.isSalesPerson"}},[a("a-select-option",{attrs:{value:"1"}},[t._v("推广员")]),a("a-select-option",{attrs:{value:"0"}},[t._v("普通用户")])],1)],1),a("a-col",{attrs:{md:8,sm:24}},[a("span",{staticClass:"table-page-search-submitButtons"},[a("a-button",{attrs:{type:"primary"},on:{click:function(e){return t.$refs.table.refresh(!0)}}},[t._v("查询")]),a("a-button",{staticStyle:{"margin-left":"8px"},on:{click:function(){return t.queryParam={}}}},[t._v("重置")])],1)])],1)],1),a("s-table",{ref:"table",attrs:{rowKey:function(t,e){return e},"row-selection":{selectedRowKeys:t.selectedRowKeys,onChange:t.onSelectChange},columns:t.columns,data:t.loadData,pageSize:5,pagination:t.pagination},scopedSlots:t._u([{key:"userInfo",fn:function(t){return[a("s-table-user",{attrs:{info:{nickName:t.nickName,headImg:t.headImg}}})]}}])})],1)},u=[],d=a("7a10"),m={components:{STable:l["p"],STableUser:l["t"]},props:{list:{type:Array}},data:function(t){var e=this;return{selectedRowKeys:[],selectedRows:[],queryParam:{},pagination:{pageNo:1,pageSize:5},columns:[{title:"会员信息",scopedSlots:{customRender:"userInfo"}},{title:"手机号",dataIndex:"telephone"},{title:"钱包余额",dataIndex:"amount"},{title:"消费累计",dataIndex:"costAmount"},{title:"总积分",dataIndex:"totalScore"},{title:"是否为推广员",dataIndex:"isSalesPerson",scopedSlots:{customRender:"isSalesPerson"}}],loadData:function(t){var a=t.pageNo,n=t.pageSize,s=e.queryParam,o=s.userName,r=s.telephone,i=s.isSalesPerson,l={page:a,limit:n,userName:o||void 0,telephone:r||void 0,isSalesPerson:i};return Object(d["g"])(l).then((function(t){var e=t.data,s=e.list,o=e.totalCount;return{pageNo:a,limit:n,data:s,totalCount:o}}))}}},methods:{onSelectChange:function(t,e){this.selectedRowKeys=t,this.selectedRows=e.map((function(t){return t.id})),this.$emit("change",this.selectedRows)}}},p=m,f=a("2877"),h=Object(f["a"])(p,c,u,!1,null,null,null),g=h.exports,v=a("17eb"),b={components:{Template:v["a"],STable:l["p"],UserList:g},data:function(){var t=this;return{userList:[],couponId:null,visible:!1,queryParam:{},COUPON_TEMPLATE_STATUS:i["d"],COUPON_TEMPLATE_TYPE:i["e"],marketTmp:[],pagination:{pageNo:1,pageSize:10},columns:[{title:"ID",dataIndex:"id",scopedSlots:{customRender:"id"}},{title:"优惠券名称",dataIndex:"template.title",scopedSlots:{customRender:"template.title"}},{title:"优惠券类型",dataIndex:"type",scopedSlots:{customRender:"type"}},{title:"领取期限",dataIndex:"time",scopedSlots:{customRender:"time"}},{title:"最低消费",dataIndex:"template.limitAmount",scopedSlots:{customRender:"template.limitAmount"}},{title:"优惠券面值",dataIndex:"template.amount",scopedSlots:{customRender:"template.amount"}},{title:"手动领取",dataIndex:"isOnce",scopedSlots:{customRender:"isOnce"}},{title:"数量",scopedSlots:{customRender:"number"}},{title:"状态",dataIndex:"status",scopedSlots:{customRender:"status"}},{title:"操作",scopedSlots:{customRender:"action"}}],loadData:function(e){var a=e.pageNo,n=e.pageSize,s=t.queryParam,i=s.title,l=s.status,c=s.templateId,u={page:a,limit:n,title:i||void 0,status:l,templateId:c||void 0};return Object(r["h"])(u).then((function(t){var e=t.data,s=e.list,r=e.totalCount,i=s.map((function(t){return Object(o["a"])(Object(o["a"])({},t),{},{loading:!1})}));return{pageNo:a,limit:n,data:i,totalCount:r}}))}}},created:function(){this.getTemplate()},methods:{getTemplate:function(){var t=this;Object(r["m"])().then((function(e){var a=e.data;t.marketTmp=a.map((function(t){return{id:t.id,title:t.title}}))}))},changeHandleStatus:function(t,e){var a=this;t.loading=!0,t.status=Number(e),Object(r["s"])({id:t.id,status:t.status}).then((function(e){setTimeout((function(){t.loading=!1,a.$message.success("修改成功")}),500)}))},changeCouponMal:function(t){this.couponId=t.id,this.visible=!0},getHandleUserList:function(t){this.userList=t},getHandleCoupons:function(){var t=this;this.userList.length>=1?Object(r["p"])({couponId:this.couponId,userIds:this.userList}).then((function(e){t.$message.success("已成功发送优惠券"),t.visible=!1})).catch((function(e){t.$message.error("发送失败")})):this.$message.warning("请选择会员")},handleDel:function(t){var e=this.$refs.table,a=this.$notification.success;this.$confirm({title:"警告",content:"是否删除",onOk:function(){Object(r["d"])(t.id).then((function(t){a({message:"成功",description:"删除成功"}),e.refresh()}))}})}}},y=b,_=Object(f["a"])(y,n,s,!1,null,null,null);e["default"]=_.exports}}]);