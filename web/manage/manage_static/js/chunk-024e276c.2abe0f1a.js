(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-024e276c"],{"5b92":function(e,t,a){"use strict";a.d(t,"d",(function(){return o})),a.d(t,"c",(function(){return i})),a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return u}));var r=a("365c"),n=a("b775"),c=r["b"].userCoupons;function o(e){return Object(n["b"])({url:c.getCouponPage,method:"get",params:e})}function i(e){return Object(n["b"])({url:c.getCheckOrderRecordPage,method:"get",params:e})}function s(e){return Object(n["b"])({url:c.changeUserCoupon,method:"patch",data:e})}function u(e){return Object(n["b"])({url:c.delUserCoupon+e,method:"delete"})}},"73df":function(e,t,a){"use strict";a.d(t,"b",(function(){return u})),a.d(t,"h",(function(){return m})),a.d(t,"c",(function(){return O})),a.d(t,"d",(function(){return y})),a.d(t,"f",(function(){return k})),a.d(t,"g",(function(){return g})),a.d(t,"a",(function(){return _})),a.d(t,"e",(function(){return I}));a("4ec9"),a("a9e3"),a("b64b"),a("d3b7"),a("25f0"),a("3ca3"),a("ddb0");var r=a("b85c"),n=a("2909"),c=a("53ca"),o=a("d4ec"),i=a("bee2"),s=a("2ef0"),u=function(){function e(){Object(o["a"])(this,e)}return Object(i["a"])(e,[{key:"setAttributes",value:function(e){var t=this,a=new Map,r=this.attributes();for(var n in r)a.set(r[n],n);for(var c in e)if(e.hasOwnProperty(c)&&a.get(c)){var o=this.getType;switch(o(t[c])){case"boolean":t[c]=!!e[c];break;case"string":t[c]=e[c]?e[c]:t[c];break;case"object":t[c]="object"===o(e[c])?e[c]:t[c];break;case"array":t[c]="array"===o(e[c])?e[c]:t[c];break;case"number":t[c]=e[c]?Number(e[c]):t[c];break;default:t[c]=e[c]}}return t}},{key:"toObject",value:function(e){var t={},a=this;for(var r in e){var n=Object(c["a"])(e[r]);if("string"===n)t[r]=a[e[r]];else if("function"===n){var o=e[r].apply();null!==o&&(t[r]=o)}}return t}},{key:"fields",value:function(){var e=this.attributes();return Object(s["zipObject"])(e,e)}},{key:"attributes",value:function(){var e=this,t=[];return t.push.apply(t,Object(n["a"])(Object.keys(e))),t}},{key:"delFields",value:function(e,t){var a,n=Object(r["a"])(t);try{for(n.s();!(a=n.n()).done;){var c=a.value;delete e[c]}}catch(o){n.e(o)}finally{n.f()}}},{key:"getType",value:function(e){var t=Object.prototype.toString.apply(e);switch(t){case"[object String]":t="string";break;case"[object Number]":t="number";break;case"[object Boolean]":t="boolean";break;case"[object Undefined]":t="undefined";break;case"[object Null]":t="null";break;case"[object Object]":t="object";break;case"[object Array]":t="array";break;case"[object Function]":t="function";break}return t}}]),e}(),l=(a("b0c0"),a("45eb")),d=a("7e84"),p=a("262e"),b=a("2caf"),f=function(e){Object(p["a"])(a,e);var t=Object(b["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.call(this),e.id="",e.name="",e.employeeNumber="",e.telephone="",e.sex=0,e.email="",e.departmentIds=[],e.updatedAt=0,e.userSnap={},e.mpOpenId="",e.mpSendMsg=0,e.openId="",e.status=0,e.roleList=[],e.isAdmin=0,e.shopId="",e.account="",e.shopInfo="",e.password="",e}return Object(i["a"])(a,[{key:"renderData",value:function(){var e=this,t=Object(l["a"])(Object(d["a"])(a.prototype),"fields",this).call(this);return t["updateAt"]=function(){return 1e3*e.updateAt},Object(l["a"])(Object(d["a"])(a.prototype),"toObject",this).call(this,t)}}]),a}(u),m=f,h=function(e){Object(p["a"])(a,e);var t=Object(b["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.call(this),e.id="",e.orderId="",e.status="",e.payAmount=0,e.updateTime=0,e.productType="",e.cartSnap=[],e.userSnap={},e.addressSnap={},e.cooperateShopSnap={},e.batchNumber="",e.trackingNumber="",e.trackingName="",e.addressSnap={},e.sharingAmount=0,e.createTime=0,e.incomeAmount=0,e.remark="",e.distribute="",e.productType="",e.expressName="",e.expressNo="",e.freightAmount="",e.couponInfo={},e.deductScore=0,e.connectSnap={},e.cooperateShopAddressSnap={},e.sendSnap={},e.sendType=0,e}return Object(i["a"])(a,[{key:"renderData",value:function(){var e=this,t=Object(l["a"])(Object(d["a"])(a.prototype),"fields",this).call(this),r=this.productType;return"POST"===r&&(t["info"]=function(){return Object(s["get"])(e,"addressSnap")}),"GROUP_BUY"===r&&(t["info"]=function(){return Object(s["get"])(e,"cooperateShopSnap")}),Object(l["a"])(Object(d["a"])(a.prototype),"delFields",this).call(this,t,["cooperateShopSnap"]),Object(l["a"])(Object(d["a"])(a.prototype),"toObject",this).call(this,t)}},{key:"renderInfo",value:function(){var e=this,t=Object(l["a"])(Object(d["a"])(a.prototype),"fields",this).call(this),r=this.productType;return"POST"===r&&(t["consigneeName"]=function(){return Object(s["get"])(e,"addressSnap.name")},t["consigneeStreet"]=function(){return Object(s["get"])(e,"addressSnap.street")},t["consigneeRoom"]=function(){return Object(s["get"])(e,"addressSnap.room")},t["consigneeTelephone"]=function(){return Object(s["get"])(e,"addressSnap.telephone")}),"GROUP_BUY"===r&&(t["shopName"]=function(){return Object(s["get"])(e,"cooperateShopSnap.shopName")},t["shopLogo"]=function(){return Object(s["get"])(e,"cooperateShopSnap.logo")},t["shopAddress"]=function(){return Object(s["get"])(e,"cooperateShopSnap.address")}),Object(l["a"])(Object(d["a"])(a.prototype),"delFields",this).call(this,t,[]),Object(l["a"])(Object(d["a"])(a.prototype),"toObject",this).call(this,t)}}]),a}(u),O=h,j=function(e){Object(p["a"])(a,e);var t=Object(b["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.call(this),e.id="",e.name="",e.type="",e.number=0,e.amount=0,e.coverImg="",e.unitSnap={},e.categorySnap={},e.skuDetail=[],e.specSnap="",e}return Object(i["a"])(a,[{key:"renderData",value:function(){var e=this,t=Object(l["a"])(Object(d["a"])(a.prototype),"fields",this).call(this);return t["unitName"]=function(){return Object(s["get"])(e,"unitSnap.name")},t["categoryName"]=function(){return Object(s["get"])(e,"categorySnap.name")},Object(l["a"])(Object(d["a"])(a.prototype),"delFields",this).call(this,t,["unitSnap","categorySnap"]),Object(l["a"])(Object(d["a"])(a.prototype),"toObject",this).call(this,t)}}]),a}(u),y=j,v=function(e){Object(p["a"])(a,e);var t=Object(b["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.call(this),e.id="",e.title="",e.couponType="",e.status=0,e.leftNumber=0,e.usedNumber=0,e.totalNumber=0,e.userSnap={},e.updateTime=0,e.orderId="",e.createdAt=0,e.expireTime=0,e}return Object(i["a"])(a,[{key:"renderData",value:function(){var e=Object(l["a"])(Object(d["a"])(a.prototype),"fields",this).call(this);return Object(l["a"])(Object(d["a"])(a.prototype),"toObject",this).call(this,e)}}]),a}(u),k=v,S=function(e){Object(p["a"])(a,e);var t=Object(b["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.call(this),e.id="",e.title="",e.couponType="",e.number=0,e.userSnap={},e.checkEmployeeSnap="",e.checkEmployeeName="",e.createdAt=0,e.shopBillAmount=0,e.title="",e}return Object(i["a"])(a,[{key:"renderData",value:function(){var e=Object(l["a"])(Object(d["a"])(a.prototype),"fields",this).call(this);return Object(l["a"])(Object(d["a"])(a.prototype),"toObject",this).call(this,e)}}]),a}(u),g=S,T=function(e){Object(p["a"])(a,e);var t=Object(b["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.call(this),e.id=0,e.name="",e.path="",e.parentId=0,e.meta={},e.show=0,e.title="",e.icon="",e.component="",e.createTime=0,e.isMenu=0,e.key="",e.redirect="",e.servicePath="",e.requestMethod="",e.sort=0,e}return Object(i["a"])(a,[{key:"MenuList",value:function(){var e=this,t=Object(l["a"])(Object(d["a"])(a.prototype),"fields",this).call(this);return t["redirect"]=function(){return""===e.redirect?void 0:e.redirect},Object(l["a"])(Object(d["a"])(a.prototype),"toObject",this).call(this,t)}},{key:"renderData",value:function(){var e=Object(l["a"])(Object(d["a"])(a.prototype),"fields",this).call(this);return Object(l["a"])(Object(d["a"])(a.prototype),"toObject",this).call(this,e)}},{key:"exportData",value:function(){var e=this,t=Object(l["a"])(Object(d["a"])(a.prototype),"fields",this).call(this);return t["meta"]=function(){return{icon:e.icon,title:e.title,show:e.show,key:e.key}},t["show"]=function(){},t["title"]=function(){},t["icon"]=function(){},t["key"]=function(){},t["createTime"]=function(){},Object(l["a"])(Object(d["a"])(a.prototype),"toObject",this).call(this,t)}}]),a}(u),_=T,x=function(e){Object(p["a"])(a,e);var t=Object(b["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.call(this),e.id=0,e.parentId=0,e.sort=0,e.status=0,e.title="",e.createdAt=0,e}return Object(i["a"])(a,[{key:"RoleList",value:function(){var e=this,t=Object(l["a"])(Object(d["a"])(a.prototype),"fields",this).call(this);return t["createdAt"]=function(){return e.createdAt},Object(l["a"])(Object(d["a"])(a.prototype),"toObject",this).call(this,t)}},{key:"exportData",value:function(){var e=Object(l["a"])(Object(d["a"])(a.prototype),"fields",this).call(this);return Object(l["a"])(Object(d["a"])(a.prototype),"toObject",this).call(this,e)}},{key:"renderData",value:function(){var e=Object(l["a"])(Object(d["a"])(a.prototype),"fields",this).call(this);return e["createdAt"]=function(){},Object(l["a"])(Object(d["a"])(a.prototype),"toObject",this).call(this,e)}}]),a}(u),I=x},e98b:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-card",{attrs:{bordered:!1}},[a("div",{staticClass:"table-page-search-wrapper"},[a("a-row",{attrs:{gutter:8}},[a("a-col",{attrs:{md:4,sm:24}},[a("a-input",{attrs:{placeholder:"订单号","allow-clear":""},model:{value:e.queryParam.orderId,callback:function(t){e.$set(e.queryParam,"orderId",t)},expression:"queryParam.orderId"}})],1),a("a-col",{attrs:{md:4,sm:24}},[a("a-input",{attrs:{placeholder:"卡券名称","allow-clear":""},model:{value:e.queryParam.title,callback:function(t){e.$set(e.queryParam,"title",t)},expression:"queryParam.title"}})],1),a("a-col",{attrs:{md:4,sm:24}},[a("a-input",{attrs:{placeholder:"用户编号","allow-clear":""},model:{value:e.queryParam.code,callback:function(t){e.$set(e.queryParam,"code",t)},expression:"queryParam.code"}})],1),a("a-col",{attrs:{md:2,sm:24}},[a("a-select",{staticClass:"width-percent-100",attrs:{allowClear:"",placeholder:"状态"},model:{value:e.queryParam.status,callback:function(t){e.$set(e.queryParam,"status",t)},expression:"queryParam.status"}},e._l(e.COUPON_STATUS,(function(t,r){return a("a-select-option",{key:r,attrs:{value:t.value}},[e._v(e._s(t.name))])})),1)],1),a("a-col",{attrs:{md:4,sm:24}},[a("a-range-picker",{staticClass:"width-percent-100",on:{change:e.createTimeChange},model:{value:e.queryParam.createdAt,callback:function(t){e.$set(e.queryParam,"createdAt",t)},expression:"queryParam.createdAt"}})],1),a("a-col",{attrs:{md:4,sm:24}},[a("span",{staticClass:"table-page-search-submitButtons"},[a("a-button",{attrs:{type:"primary"},on:{click:function(t){return e.$refs.table.refresh(!0)}}},[e._v("查询")]),a("a-button",{staticClass:"margin-left-8",on:{click:function(){return e.queryParam={}}}},[e._v("重置")])],1)])],1)],1),a("s-table",{ref:"table",attrs:{rowKey:function(e,t){return t},columns:e.columns,pagination:e.pagination,data:e.loadData},scopedSlots:e._u([{key:"id",fn:function(e){return[a("s-table-text",{attrs:{text:e}})]}},{key:"titles",fn:function(e,t){return[a("s-table-text",{attrs:{text:t.title}})]}},{key:"userInfo",fn:function(e){return[a("s-table-user",{attrs:{info:e}})]}},{key:"totalNumber",fn:function(t,a){return[e._v(" "+e._s(a.usedNumber)+" / "+e._s(a.totalNumber)+" ")]}},{key:"couponType",fn:function(t){return[a("s-table-type",{attrs:{text:t,list:e.COUPON_TYPE}})]}},{key:"status",fn:function(t){return[a("s-table-type",{attrs:{text:t,list:e.COUPON_STATUS}})]}},{key:"createdAt",fn:function(t){return[a("span",t?[e._v(e._s(e._f("parseTime")(t)))]:[e._v("无")])]}},{key:"expireTime",fn:function(t){return[a("span",t?[e._v(e._s(e._f("parseTime")(t)))]:[e._v("无")])]}},{key:"action",fn:function(t){return[0===t.status?a("a",{on:{click:function(a){return e.handleUpdate(t)}}},[e._v("核销")]):e._e(),0===t.status?a("a-divider",{attrs:{type:"vertical"}}):e._e(),a("a",{on:{click:function(a){return e.handleDetail(t)}}},[e._v("详情")])]}}])})],1),a("a-modal",{attrs:{title:e.update.title},on:{ok:e.handleOkUpdate},model:{value:e.update.visible,callback:function(t){e.$set(e.update,"visible",t)},expression:"update.visible"}},[a("a-form",{attrs:{form:e.update.form}},[a("a-form-item",{attrs:{label:"核销数量","label-col":{span:7},"wrapper-col":{span:12},help:"核销数量不能大于总数"}},[a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["number",{rules:[{required:!0,message:"请输入核销数量"}],initialValue:1}],expression:"['number',{rules: [{ required: true, message: '请输入核销数量' }], initialValue: 1}]"}],staticClass:"width-percent-100",attrs:{min:0,max:e.update.leftNumber}})],1)],1)],1),a("a-modal",{attrs:{title:e.detail.title,width:800,footer:null},model:{value:e.detail.visible,callback:function(t){e.$set(e.detail,"visible",t)},expression:"detail.visible"}},[a("a-table",{attrs:{rowKey:function(e,t){return t},columns:e.detail.columns,scroll:{y:300},dataSource:e.detail.dataSource},scopedSlots:e._u([{key:"checkEmployeeName",fn:function(t){return[e._v(e._s(t))]}},{key:"b-title",fn:function(e,t){return[a("s-table-text",{attrs:{text:t.title}})]}},{key:"couponType",fn:function(t){return["COUNTS"===t?a("span",[e._v("记次/时商品")]):e._e(),"VIR"===t?a("span",[e._v("虚拟商品")]):e._e(),"REAL"===t?a("span",[e._v("实物商品")]):e._e()]}},{key:"userInfo",fn:function(e){return[a("s-table-user",{attrs:{info:e}})]}},{key:"number",fn:function(t){return[e._v(e._s(t)+" 张")]}},{key:"createdAt",fn:function(t){return[e._v(e._s(e._f("parseTime")(t)))]}}])})],1)],1)},n=[],c=(a("d81d"),a("5530")),o=a("73df"),i=a("2af9"),s=a("5b92"),u=a("f121"),l=a("ed08"),d={name:"ShopCouponList",components:{STable:i["p"],STableType:i["s"],STableUser:i["t"],STableText:i["r"]},data:function(){var e=this;return{COUPON_TYPE:u["f"],COUPON_STATUS:u["c"],queryParam:{createdAt:["",""]},columns:[{title:"订单号",dataIndex:"orderId",scopedSlots:{customRender:"orderId"}},{title:"卡券名称",dataIndex:"titles",scopedSlots:{customRender:"titles"}},{title:"用户信息",dataIndex:"userSnap",scopedSlots:{customRender:"userInfo"}},{title:"已使用 / 总数",dataIndex:"totalNumber",scopedSlots:{customRender:"totalNumber"}},{title:"卡券类型",dataIndex:"couponType",scopedSlots:{customRender:"couponType"}},{title:"状态",dataIndex:"status",scopedSlots:{customRender:"status"}},{title:"生成时间",dataIndex:"createdAt",scopedSlots:{customRender:"createdAt"}},{title:"过期时间",dataIndex:"expireTime",scopedSlots:{customRender:"expireTime"}},{title:"操作",scopedSlots:{customRender:"action"}}],pagination:{pageSize:10,current:1},pageTemp:0,loadData:function(t){var a=t.pageSize,r=t.pageNo,n=e.queryParam,c=n.orderId,i=n.title,u=n.code,d=n.status,p=n.createdAt,b={page:r,limit:a,orderId:c||void 0,title:i||void 0,code:u||void 0,status:d||void 0,geCreatedAt:p[0]?p[0]+" 00:00:00":void 0,leCreatedAt:p[1]?p[1]+" 23:59:59":void 0};return Object(s["d"])(b).then((function(e){var t=e.data.list,n=t.map((function(e){var t=new o["f"];return t.setAttributes(e).renderData()}));return Object(l["a"])(),{pageNo:r,pageSize:a,data:n,totalCount:0}}))},update:{temp:{},form:null,title:"",visible:!1,leftNumber:0},detail:{temp:{},title:"161616",visible:!1,columns:[{title:"核销人",dataIndex:"checkEmployeeName",scopedSlots:{customRender:"checkEmployeeName"},width:127},{title:"卡券名称",dataIndex:"title",scopedSlots:{customRender:"b-title"},width:152},{title:"用户信息",dataIndex:"userSnap",scopedSlots:{customRender:"userInfo"},width:152},{title:"核销数量",dataIndex:"number",scopedSlots:{customRender:"number"},width:152},{title:"核销时间",dataIndex:"createdAt",scopedSlots:{customRender:"createdAt"},width:152}],dataSource:[]}}},created:function(){},methods:{createTimeChange:function(e,t){this.queryParam.createdAt=t},handleUpdate:function(e){var t=this.update,a=this.$message.warning;e.leftNumber>0?(t.temp=e,t.title=e.title,t.form=this.$form.createForm(this),t.leftNumber=e.leftNumber,t.visible=!0):a("剩余数量不足")},handleOkUpdate:function(){var e=this;Object(l["r"])(Object(c["a"])({},this.queryParam));var t=this.update,a=t.form.validateFields,r=t.temp.orderId,n=this.$refs.table,o=this.$notification.success;a((function(t,a){if(!t){var i=Object(c["a"])(Object(c["a"])({},a),{},{orderId:r});Object(s["a"])(i).then((function(t){o({message:"成功",description:"核销成功"}),n.refresh(!0),e.update.visible=!1}))}}))},handleDelete:function(e){var t=e.id,a=e.couponName;Object(l["r"])(Object(c["a"])({},this.queryParam));var r=this.$refs.table,n=this.$notification.success;this.$confirm({title:"警告",content:"是否删除 ".concat(a," 吗?"),onOk:function(){Object(s["b"])(t).then((function(e){n({message:"成功",description:"删除成功"}),r.refresh(!0)}))}})},handleDetail:function(e){var t=this.detail,a=this.$message.warning;t.temp=e,t.title="".concat(e.title),Object(s["c"])({orderId:e.orderId}).then((function(e){var a=e.data.list,r=a.map((function(e){var t=new o["g"];return t.setAttributes(e).renderData()}));t.dataSource=r,t.visible=!0})).catch((function(){a("获取卡券详情失败")}))}}},p=d,b=a("2877"),f=Object(b["a"])(p,r,n,!1,null,null,null);t["default"]=f.exports}}]);