(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0e658d4e"],{"117f":function(t,e,a){},"16aa":function(t,e,a){"use strict";a("3a62")},"1ac0":function(t,e,a){"use strict";a("f8ef")},"3a62":function(t,e,a){},"5f05":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"product-list"},[a("a-card",{attrs:{bordered:!1}},[a("div",{staticClass:"table-page-search-wrapper"},[a("a-row",{attrs:{gutter:10}},[a("a-col",{attrs:{md:5,sm:24}},[a("a-input",{attrs:{clearable:"",placeholder:"商品名称"},model:{value:t.queryParam.name,callback:function(e){t.$set(t.queryParam,"name",e)},expression:"queryParam.name"}})],1),a("a-col",{attrs:{md:3,sm:24}},[a("a-cascader",{staticClass:"width-percent-100",attrs:{options:t.categoryOptions,fieldNames:{label:"name",value:"id",children:"children"},placeholder:"商品分类",changeOnSelect:"",allowClear:""},model:{value:t.queryParam.categoryId,callback:function(e){t.$set(t.queryParam,"categoryId",e)},expression:"queryParam.categoryId"}})],1),a("a-col",{attrs:{md:3,sm:24}},[a("a-select",{staticClass:"width-percent-100",attrs:{allowClear:"",placeholder:"商品规格"},model:{value:t.queryParam.isSku,callback:function(e){t.$set(t.queryParam,"isSku",e)},expression:"queryParam.isSku"}},[a("a-select-option",{attrs:{value:0}},[t._v("单规格")]),a("a-select-option",{attrs:{value:1}},[t._v("多规格")])],1)],1),a("a-col",{attrs:{md:3,sm:24}},[a("a-select",{staticClass:"width-percent-100",attrs:{allowClear:"",placeholder:"上架"},model:{value:t.queryParam.isOnSale,callback:function(e){t.$set(t.queryParam,"isOnSale",e)},expression:"queryParam.isOnSale"}},[a("a-select-option",{attrs:{value:1}},[t._v("上架")]),a("a-select-option",{attrs:{value:0}},[t._v("下架")])],1)],1),a("a-col",{attrs:{md:6,sm:24}},[a("span",{staticClass:"table-page-search-submitButtons"},[a("a-button",{attrs:{type:"primary"},on:{click:function(e){return t.$refs.table.refresh(!0)}}},[t._v("搜索")]),a("a-button",{staticStyle:{"margin-left":"8px"},on:{click:t.handleReset}},[t._v("重置")])],1)])],1)],1),a("div",{staticClass:"table-operator"},[a("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:function(e){return t.handleAdd()}}},[t._v("添加商品")]),a("a-button",{attrs:{icon:"folder-open"},on:{click:t.getExport}},[t._v("导出")])],1),a("s-table",{ref:"table",staticClass:"product-list-table",attrs:{rowKey:function(t,e){return e},data:t.loadData,columns:t.columns,pagination:t.pagination},scopedSlots:t._u([{key:"id",fn:function(t){return a("span",{},[a("popover-text",{attrs:{text:String(t),max:8}})],1)}},{key:"images",fn:function(t){return[a("preview",{attrs:{img:t.images[0],name:t.name}})]}},{key:"showOrder",fn:function(e,n){return a("span",{},[a("edit-show-order",{attrs:{text:e},on:{change:function(e){return t.onEditChange(n.id,"showOrder",e)}}})],1)}},{key:"name",fn:function(e,n){return a("span",{},[a("edit-name",{attrs:{text:e,scope:n},on:{change:function(e){return t.onEditChange(n.id,"name",e)}}})],1)}},{key:"categorySnap",fn:function(e){return[a("a-popover",{attrs:{placement:"topLeft",overlayStyle:{"max-width":"400px"}}},[a("template",{slot:"content"},[t._v(t._s(e.join("、")))]),a("div",{staticClass:"categorySnap-class"},t._l(e,(function(e,n){return a("a-tag",{key:n,staticClass:"categorySnap-tag"},[t._v(t._s(e))])})),1)],2)]}},{key:"salePrice",fn:function(e){return[t._v(t._s(t._f("moneyFormat")(e)))]}},{key:"memberPrice",fn:function(e){return[t._v(t._s(t._f("moneyFormat")(e)))]}},{key:"stockNumber",fn:function(e){return[t._v(" "+t._s(e.realSalesNumber||0)+" / "+t._s(e.stockNumber)+" ")]}},{key:"updatedAt",fn:function(e){return a("span",{},[t._v(t._s(t._f("parseTime")(e,"YYYY-MM-DD")))])}},{key:"isOnSale",fn:function(e,n){return a("span",{},[a("a-switch",{attrs:{loading:n.onSaleLoading,checked:1===e,checkedChildren:"上架",unCheckedChildren:"下架"},on:{change:function(e){return t.changeOnSale(n)}}})],1)}},{key:"action",fn:function(e){return a("span",{},[a("a",{on:{click:function(a){return t.handleEdit(e)}}},[t._v("编辑")]),a("a-divider",{attrs:{type:"vertical"}}),a("a-dropdown",{attrs:{trigger:["click"]}},[a("a",[t._v("更多 "),a("a-icon",{attrs:{type:"down"}})],1),a("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[a("a-menu-item",{on:{click:function(a){return t.productStockDetail(e)}}},[a("a",[t._v("销售记录")])]),a("a-menu-item",{on:{click:function(a){return t.handleClean(e)}}},[a("a",[t._v("清除分享图")])]),a("a-menu-item",{on:{click:function(a){return t.handleDelete(e)}}},[a("a",{staticClass:"color-red"},[t._v("删除")])])],1)],1)],1)}},{key:"expandedRowRender",fn:function(e){return a("a-table",{attrs:{rowKey:function(t){return t.id},columns:t.innerColumns,"data-source":e.skuList,pagination:!1},scopedSlots:t._u([{key:"i-action",fn:function(e,n){return[a("a",{on:{click:function(e){return t.handleStockDetail(n)}}},[t._v("销售详情")])]}}])})}}])})],1)],1)},i=[],c=(a("d81d"),a("b0c0"),a("5530")),s=a("ade3"),r=a("66da"),o=a("4c79"),l=a("ed08"),u=a("3232"),d=a("2af9"),p=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"editable-cell"},[t.editable?a("div",{staticClass:"editable-cell-input-wrapper"},[a("a-input",{staticStyle:{"font-size":"12px"},attrs:{value:t.value},on:{change:t.handleChange,pressEnter:t.check}}),a("a-icon",{staticClass:"editable-cell-icon-check",attrs:{type:"check"},on:{click:t.check}})],1):a("div",{staticClass:"editable-cell-text-wrapper"},[1===t.row.combo?a("span",{staticClass:"id-combo"},[t._v("套")]):t._e(),a("a-popover",{attrs:{placement:"topLeft",arrowPointAtCenter:""}},[a("template",{slot:"content"},[t._v(t._s(t.value))]),a("span",[t._v(t._s(t._f("textOverflowEllipsis")(t.value,0,15)))])],2),a("a-icon",{staticClass:"editable-cell-icon",attrs:{type:"edit"},on:{click:t.edit}})],1)])},h=[],m={props:{text:{type:String,required:!0},scope:{type:Object,required:!0}},data:function(){return{value:this.text,row:this.scope,editable:!1}},watch:{text:function(t){this.value=t},scope:function(t){this.row=t}},methods:{handleChange:function(t){var e=t.target.value;this.value=e},check:function(){this.editable=!1,this.$emit("change",this.value)},edit:function(){this.editable=!0}}},f=m,v=(a("c1e2"),a("2877")),b=Object(v["a"])(f,p,h,!1,null,"1ca8ec2a",null),g=b.exports,k=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"editable-cell"},[t.editable?a("div",{staticClass:"editable-cell-input-wrapper"},[a("a-input-number",{staticClass:"editable-cell-input",attrs:{value:t.value,min:0,precision:0},on:{change:t.handleChange,pressEnter:t.check}}),a("a-icon",{staticClass:"editable-cell-icon-check",attrs:{type:"check"},on:{click:t.check}})],1):a("div",{staticClass:"editable-cell-text-wrapper"},[t._v(" "+t._s(t.value)+" "),t.unitSnap.name?a("span",[t._v(" "+t._s(t.unitSnap.name))]):t._e(),a("a-icon",{staticClass:"editable-cell-icon",attrs:{type:"edit"},on:{click:t.edit}})],1)])},S=[],y=(a("a9e3"),{props:{text:{type:Number,default:null},unitSnap:{type:Object,default:function(){return{}}}},data:function(){return{value:this.text,editable:!1}},watch:{text:function(t){this.value=t},unitSnap:function(t){this.unitSnap=t}},methods:{handleChange:function(t){this.value=t},check:function(){this.editable=!1,this.$emit("change",this.value)},edit:function(){this.editable=!0}}}),O=y,_=(a("16aa"),Object(v["a"])(O,k,S,!1,null,"09e33567",null)),C=_.exports,w=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"editable-cell"},[t.editable?a("div",{staticClass:"editable-cell-input-wrapper"},[a("a-input-number",{staticClass:"editable-cell-input",attrs:{value:t.value,min:0,precision:2},on:{change:t.handleChange,pressEnter:t.check}}),a("a-icon",{staticClass:"editable-cell-icon-check",attrs:{type:"check"},on:{click:t.check}})],1):a("div",{staticClass:"editable-cell-text-wrapper"},[a("span",[t._v(t._s(t._f("moneyFormat")(t.value||" ")))]),t.unitSnap.name?a("span",[t._v(" / "+t._s(t.unitSnap.name))]):t._e(),a("a-icon",{staticClass:"editable-cell-icon",attrs:{type:"edit"},on:{click:t.edit}})],1)])},x=[],P={props:{text:{type:Number,default:0},unitSnap:{type:Object,default:function(){return{}}}},data:function(){return{value:this.text,editable:!1}},watch:{text:function(t){this.value=t},unitSnap:function(t){this.unitSnap=t}},methods:{handleChange:function(t){this.value=t},check:function(){this.editable=!1,this.$emit("change",this.value)},edit:function(){this.editable=!0}}},j=P,q=(a("1ac0"),Object(v["a"])(j,w,x,!1,null,"7c7652cf",null)),$=q.exports,E=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"editable-cell"},[t.editable?a("div",{staticClass:"editable-cell-input-wrapper"},[a("a-input-number",{staticClass:"editable-cell-input",attrs:{value:t.value,min:0,max:1e7,precision:0},on:{change:t.handleChange,pressEnter:t.check}}),a("a-icon",{staticClass:"editable-cell-icon-check",attrs:{type:"check"},on:{click:t.check}})],1):a("div",{staticClass:"editable-cell-text-wrapper"},[t._v(" "+t._s(t.value)+" "),t.unitSnap.name&&null!==t.value?a("span",[t._v(" "+t._s(t.unitSnap.name))]):t._e(),a("a-icon",{staticClass:"editable-cell-icon",attrs:{type:"edit"},on:{click:t.edit}})],1)])},I=[],D={props:{text:{type:Number,default:null},unitSnap:{type:Object,default:function(){return{}}}},data:function(){return{value:this.text,editable:!1}},watch:{text:function(t){this.value=t},unitSnap:function(t){this.unitSnap=t}},methods:{handleChange:function(t){this.value=t},check:function(){this.editable=!1,this.$emit("change",this.value)},edit:function(){this.editable=!0}}},R=D,L=(a("782f"),Object(v["a"])(R,E,I,!1,null,"870d31dc",null)),N=L.exports,A=a("c8c3"),T=a("17eb"),F=!1,z={},Y={name:"ProductList",components:{Template:T["a"],STable:d["p"],EditName:g,EditShowOrder:C,EditPrice:$,EditLimit:N,PageView:A["a"],PopoverText:d["n"],preview:d["w"]},data:function(){var t=this;return{queryParam:{isOnSale:void 0,categoryId:void 0},columns:[{title:"ID",dataIndex:"id",scopedSlots:{customRender:"id"}},{title:"商品信息",scopedSlots:{customRender:"images"}},{title:"商品分类",dataIndex:"categorySnap",scopedSlots:{customRender:"categorySnap"},width:200},{title:"售价",dataIndex:"salePrice",scopedSlots:{customRender:"salePrice"},width:130},{title:"会员价",dataIndex:"memberPrice",scopedSlots:{customRender:"memberPrice"},width:130},{title:"销量 / 库存",scopedSlots:{customRender:"stockNumber"},width:130},{title:"上架",dataIndex:"isOnSale",scopedSlots:{customRender:"isOnSale"},width:100},{title:"排序",dataIndex:"showOrder",sorter:!0,scopedSlots:{customRender:"showOrder"},width:120},{title:"更新时间",dataIndex:"updatedAt",sorter:!0,scopedSlots:{customRender:"updatedAt"},width:130},{title:"操作",scopedSlots:{customRender:"action"},width:140}],innerColumns:[{title:"商品ID",dataIndex:"productId",width:190,ellipsis:!0},{title:"商品规格",dataIndex:"specSnap",scopedSlots:{customRender:"i-specSnap"},ellipsis:!0,width:270},{title:"库存",dataIndex:"stockNumber",width:"8%"},{title:"商品条码",dataIndex:"barCode",ellipsis:!0},{title:"操作",scopedSlots:{customRender:"i-action"},width:100}],pagination:{pageSize:10,current:1},pageTemp:0,loadData:function(e){var a=e.pageSize,n=e.sortField,i=e.sortOrder,r=void 0===i?"ascend":i;e.sortField="showOrder"===n?"show_order":"updated_at";var d=e.pageNo,p={page:d,limit:a};t.queryParam.pageData=p.page;var h=new u["a"],m=t.queryParam,f=m.name,v=m.isSku,b=t.queryParam,g=b.isOnSale,k=b.categoryId,S=b.isStock;return h.setOrderBy(n,r),F&&(t.queryParam.pageData=z.pageData,t.queryParam.categoryId=z.categoryId,t.queryParam.isOnSale=z.isOnSale,t.queryParam.isStock=z.isStock,k=z.categoryId,g=z.isOnSale,S=z.isStock,p.page=z.pageData,d=z.pageData),p.isSku=v,p.name=f,p.isOnSale=g,p.isStock=S,p.categoryId=k,p.saleStrategy="SCORE",p.orders={stock_number:"ascend"===r?"asc":"desc"},p.orders=void 0===n?void 0:Object(s["a"])({},e.sortField,"ascend"===r?"asc":"desc"),t.params=p,Object(o["k"])(p).then((function(t){var e=t.data,n=e.list,i=e.totalCount,s=n.map((function(t){return Object(c["a"])(Object(c["a"])({},t),{},{stockLoading:!1,onSaleLoading:!1})}));return F=!1,Object(l["a"])(),{pageNo:d,pageSize:a,data:s,totalCount:i}}))},categoryOptions:[],weightUnit:{name:"克"}}},created:function(){this.getCategoryList()},methods:{onEditChange:function(t,e,a){var n=this;void 0===a&&(a=null),Object(o["s"])(Object(s["a"])({id:t},e,a)).then((function(t){n.$message.success("修改成功")}))},changeStock:function(t){t.stockLoading=!0;var e=t.isStock;t.isStock=1===t.isStock?0:1;var a=t.id,n=t.isStock,i=this.$message.success;Object(o["s"])({id:a,isStock:n}).then((function(e){i("修改成功"),setTimeout((function(){t.stockLoading=!1}),500)})).catch((function(){t.isStock=e,t.stockLoading=!1}))},changeOnSale:function(t){t.onSaleLoading=!0;var e=t.isOnSale;t.isOnSale=1===t.isOnSale?0:1;var a=t.id,n=t.isOnSale,i=this.$message.success;Object(o["s"])({id:a,isOnSale:n}).then((function(e){i("修改成功"),setTimeout((function(){t.onSaleLoading=!1}),1e3)})).catch((function(){t.isOnSale=e}))},getCategoryList:function(){var t=this;Object(r["e"])().then((function(e){var a=e.data;t.categoryOptions=Object(l["u"])(a)}))},handleAdd:function(){Object(l["r"])(Object(c["a"])({},this.queryParam)),this.$router.push({name:"marketProductAdd",params:{type:"SCORE"}})},handleEdit:function(t){Object(l["r"])(Object(c["a"])({},this.queryParam)),this.$router.push({name:"marketProductEdit",params:{id:t.id,type:"SCORE"}})},handleDelete:function(t){F=!0,Object(l["r"])(Object(c["a"])({},this.queryParam));var e=this.$refs.table,a=this.$notification.success;this.$confirm({title:"警告",content:"确定删除 [ ".concat(t.name," ] 吗?"),onOk:function(){z=Object(l["s"])(),Object(o["f"])(t.id).then((function(t){a({message:"成功",description:"删除成功"}),e.refresh(!0)}))}})},handleClean:function(t){F=!0,Object(l["r"])(Object(c["a"])({},this.queryParam));var e=this.$refs.table,a=this.$notification.success;this.$confirm({title:"警告",content:"是否清除分享图?",onOk:function(){z=Object(l["s"])(),Object(o["d"])(t.id).then((function(t){a({message:"成功",description:"清除成功"}),e.refresh()}))}})},handleStockDetail:function(t){this.$router.push({name:"ProductStockDetail",params:{id:t.id}})},handleReset:function(){this.queryParam={pageData:0},F=!1},getExport:function(){Object(o["o"])(this.params)},productStockDetail:function(t){this.$router.push({name:"ProductStockDetail",params:{productId:t.id}})}}},B=Y,J=(a("c74a"),Object(v["a"])(B,n,i,!1,null,"6ebff127",null));e["default"]=J.exports},"782f":function(t,e,a){"use strict";a("7d5b")},"7d5b":function(t,e,a){},b887:function(t,e,a){},c1e2:function(t,e,a){"use strict";a("b887")},c74a:function(t,e,a){"use strict";a("117f")},f8ef:function(t,e,a){}}]);