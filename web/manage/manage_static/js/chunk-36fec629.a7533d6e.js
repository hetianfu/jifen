(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-36fec629"],{"078a4":function(t,e,a){},"0e7f":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-card",[a("a-button",{staticClass:"margin-bottom-16",attrs:{type:"primary"},on:{click:t.handleAdd}},[a("a-icon",{attrs:{type:"plus"}}),t._v("添加模板")],1),a("s-table",{ref:"table",attrs:{rowKey:"id",columns:t.columns,data:t.loadData,pagination:t.pagination},scopedSlots:t._u([{key:"templateMap",fn:function(e){return a("span",{},[a("a-popover",{attrs:{placement:"topLeft",arrowPointAtCenter:""}},[a("template",{slot:"content"},[a("div",{style:{maxWidth:"400px"}},[t._v(t._s(e.templateMap))])]),a("span",t._l(e.templateMap,(function(e,s){return a("a-tag",{key:s},[t._v(t._s(e))])})),1)],2)],1)}},{key:"type",fn:function(e){return a("span",{},t._l(t.SMS_TEMPLATE_TYPE,(function(s){return s.key===e.type?a("span",{key:s.key},[t._v(t._s(s.value))]):t._e()})),0)}},{key:"createdAt",fn:function(e){return a("span",{},[t._v(t._s(t._f("parseTime")(e.createdAt,"YYYY-MM-DD HH:mm")))])}},{key:"action",fn:function(e){return a("span",{},[a("a",{on:{click:function(a){return t.handleEdit(e)}}},[t._v("编辑")]),a("a-divider",{attrs:{type:"vertical"}}),a("a",{staticClass:"color-red",on:{click:function(a){return t.handleDel(e)}}},[t._v("删除")])],1)}}])}),a("a-modal",{attrs:{title:t.sms.title,width:"600px"},on:{ok:function(e){"add"===t.sms.status?t.handleSubAdd():t.handleSubEdit()}},model:{value:t.sms.visible,callback:function(e){t.$set(t.sms,"visible",e)},expression:"sms.visible"}},[a("a-form",{attrs:{form:t.sms.form,"label-col":{span:4},"wrapper-col":{span:18}}},["edit"===t.sms.status?a("a-form-item",{staticClass:"display-none",attrs:{label:"ID"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["id"],expression:"['id']"}]})],1):t._e(),a("a-form-item",{attrs:{label:"模板编号"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["code",{rules:[{required:!0,message:"请输入模板编号"}]}],expression:"['code', { rules: [{ required: true, message: '请输入模板编号' }] }]"}],attrs:{placeholder:"请输入模板编号"}})],1),a("a-form-item",{attrs:{label:"模板名称"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请输入模板名称"}]}],expression:"['name', { rules: [{ required: true, message: '请输入模板名称' }] }]"}],attrs:{placeholder:"请输入模板名称"}})],1),a("a-form-item",{attrs:{label:"类型"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["type",{initialValue:"REG"}],expression:"['type', { initialValue: 'REG' }]"}],staticClass:"width-percent-100"},t._l(t.SMS_TEMPLATE_TYPE,(function(e){return a("a-select-option",{key:e.key},[t._v(" "+t._s(e.value)+" ")])})),1)],1),a("a-form-item",{attrs:{label:"签名"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["signName",{rules:[{required:!0,message:"请输入签名"}]}],expression:"['signName', { rules: [{ required: true, message: '请输入签名' }] }]"}],attrs:{placeholder:"请输入签名"}})],1),a("a-form-item",{attrs:{label:"填充内容"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["templateMap"],expression:"['templateMap']"}],staticClass:"display-none"}),a("div",[t._l(t.tags,(function(e){return[a("a-tag",{key:e,staticClass:"tagClass",attrs:{closable:""},on:{close:function(a){return t.handleClose(e)}}},[t._v(" "+t._s(e)+" ")])]})),t.inputVisible?a("a-input",{ref:"input",staticStyle:{width:"78px",height:"30px"},attrs:{type:"text",size:"small",value:t.inputValue},on:{change:t.handleInputChange,blur:t.handleInputConfirm}}):a("a-tag",{staticClass:"tagClass tagInput",on:{click:t.showInput}},[a("a-icon",{attrs:{type:"plus"}}),t._v(" 添加内容 ")],1)],2)],1)],1)],1)],1)},n=[],i=(a("4de4"),a("a15b"),a("b0c0"),a("d3b7"),a("ac1f"),a("6062"),a("3ca3"),a("1276"),a("498a"),a("ddb0"),a("2909")),r=a("2af9"),o=a("30e1"),l=a("f121"),c=a("2ef0"),u={components:{STable:r["p"]},data:function(){return{SMS_TEMPLATE_TYPE:l["s"],inputVisible:!1,inputValue:"",tags:[],sms:{title:"",status:"",form:null,visible:!1},columns:[{title:"模板编号",dataIndex:"code",width:150,ellipsis:!0},{title:"模板名称",dataIndex:"name"},{title:"类型",scopedSlots:{customRender:"type"}},{title:"签名",dataIndex:"signName"},{title:"填充内容",scopedSlots:{customRender:"templateMap"}},{title:"添加时间",scopedSlots:{customRender:"createdAt"}},{title:"操作",scopedSlots:{customRender:"action"}}],pagination:{pageSize:10,current:1},loadData:function(t){var e=t.pageNo,a=t.pageSize,s={page:e,limit:a};return Object(o["d"])(s).then((function(t){var s=t.data,n=s.list,i=s.totalCount;return{pageNo:e,pageSize:a,data:n,totalCount:i}}))}}},created:function(){},methods:{setSms:function(t){this.sms=Object.assign(this.sms,t)},handleAdd:function(){this.tags=[],this.setSms({title:"添加模板",status:"add",form:this.$form.createForm(this),visible:!0})},handleSubAdd:function(){var t=this,e=this.$refs.table,a=this.$notification.success;this.sms.form.validateFields((function(s,n){s||(n.templateMap=n.templateMap.split(","),Object(o["a"])(n).then((function(s){a({message:"成功",description:"添加成功"}),e.refresh(),t.setSms({visible:!1})})))}))},handleEdit:function(t){var e=this,a=Object(c["cloneDeep"])(t);this.setSms({title:"编辑  [ ".concat(a.name," ]"),status:"edit",form:this.$form.createForm(this),visible:!0}),new Promise((function(t){setTimeout(t,0)})).then((function(){e.tags=t.templateMap,e.sms.form.setFieldsValue({templateMap:e.tags.join(",")}),e.sms.form.setFieldsValue(Object(c["pick"])(t,["id","code","name","type","signName"]))}))},handleSubEdit:function(){var t=this;this.confirmLoading=!0;var e=this.$refs.table,a=this.$notification.success;this.sms.form.validateFields((function(s,n){s||(n.templateMap=n.templateMap.split(","),Object(o["e"])(n).then((function(s){a({message:"成功",description:"编辑成功"}),e.refresh(),t.setSms({visible:!1})}))),setTimeout((function(){t.confirmLoading=!1}),1e3)}))},handleDel:function(t){var e=this.$refs.table,a=this.$notification.success;this.$confirm({title:"警告",content:"是否删除[ ".concat(t.name," ]"),onOk:function(){Object(o["b"])(t.id).then((function(t){a({message:"成功",description:"删除成功"}),e.refresh()}))}})},showInput:function(){this.inputVisible=!0,this.$nextTick((function(){this.$refs.input.focus()}))},handleInputChange:function(t){this.inputValue=t.target.value},handleInputConfirm:function(){""!==this.inputValue.trim()&&this.tags.push(this.inputValue.trim()),this.tags=Object(i["a"])(new Set(this.tags)),this.inputValue="",this.inputVisible=!1,this.sms.form.setFieldsValue({templateMap:this.tags.join(",")})},handleClose:function(t){this.tags=this.tags.filter((function(e){return e!==t})),this.sms.form.setFieldsValue({templateMap:this.tags.join(",")})}}},d=u,m=(a("933c"),a("2877")),p=Object(m["a"])(d,s,n,!1,null,"65336355",null);e["default"]=p.exports},"30e1":function(t,e,a){"use strict";a.d(e,"d",(function(){return r})),a.d(e,"a",(function(){return o})),a.d(e,"e",(function(){return l})),a.d(e,"b",(function(){return c})),a.d(e,"c",(function(){return u})),a.d(e,"f",(function(){return d}));a("99af");var s=a("365c"),n=a("b775"),i=s["a"].smsManage;function r(t){return Object(n["b"])({url:i.smsManageGetPage,method:"get",params:t})}function o(t){return Object(n["b"])({url:i.smsManageAdd,method:"post",data:t})}function l(t){return Object(n["b"])({url:i.smsManageUpdateById,method:"patch",data:t})}function c(t){return Object(n["b"])({url:"".concat(i.smsManageDelById).concat(t),method:"delete"})}function u(t){return Object(n["b"])({url:i.smsManageGetLogPage,method:"get",params:t})}function d(t){return Object(n["b"])({url:s["c"]+"/sms-template/log-re-send",method:"post",data:t})}},"933c":function(t,e,a){"use strict";a("078a4")}}]);