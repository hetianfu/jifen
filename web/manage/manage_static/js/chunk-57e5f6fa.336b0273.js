(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-57e5f6fa"],{"6dfa":function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"e",(function(){return l})),n.d(t,"b",(function(){return d}));n("99af");var a=n("365c"),i=n("b775"),r=a["b"].channel;function o(e){return Object(i["b"])({url:r.channelGetPage,method:"get",params:e})}function s(e){return Object(i["b"])({url:r.channelGetList,method:"get",params:e})}function c(e){return Object(i["b"])({url:r.channelAdd,method:"post",data:e})}function l(e){return Object(i["b"])({url:r.channelUpdateById,method:"patch",data:e})}function d(e){return Object(i["b"])({url:"".concat(r.channelDelById).concat(e),method:"delete"})}},e816:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-card",[n("a-button",{staticClass:"margin-bottom-16",attrs:{type:"primary"},on:{click:e.handleAdd}},[n("a-icon",{attrs:{type:"plus"}}),e._v("添加渠道")],1),n("a-alert",{staticClass:"margin-bottom-16",attrs:{message:"如果预览未生效，请清理浏览器缓存",banner:""}}),n("s-table",{ref:"table",attrs:{rowKey:"id",columns:e.columns,data:e.loadData,pagination:e.pagination,scroll:{x:1300}},scopedSlots:e._u([{key:"fullUrl",fn:function(t){return n("span",{},[n("a",{attrs:{href:e.origin+"/pages/tabbar/home/index?s="+t.id,target:"_blank"}},[e._v("预览")])])}},{key:"action",fn:function(t){return n("span",{},[n("a",{attrs:{href:e.origin+"/pages/tabbar/home/index?s="+t.id,target:"_blank"}},[e._v("预览")]),n("a-divider",{attrs:{type:"vertical"}}),n("a",{on:{click:function(n){return e.handleEdit(t)}}},[e._v("编辑")]),n("a-divider",{attrs:{type:"vertical"}}),n("a",{staticClass:"color-red",on:{click:function(n){return e.handleDel(t)}}},[e._v("删除")])],1)}}])}),n("a-modal",{attrs:{title:e.channel.title,confirmLoading:e.confirmLoading,width:"600px"},on:{ok:function(t){"add"===e.channel.status?e.handleSubAdd():e.handleSubEdit()}},model:{value:e.channel.visible,callback:function(t){e.$set(e.channel,"visible",t)},expression:"channel.visible"}},[n("a-form",{attrs:{form:e.channel.form,"label-col":{span:4},"wrapper-col":{span:18}}},["edit"===e.channel.status?n("a-form-item",{staticClass:"display-none",attrs:{label:"ID"}},[n("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["id"],expression:"['id']"}]})],1):e._e(),n("a-form-item",{attrs:{label:"渠道名称"}},[n("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["brand",{rules:[{required:!0,message:"请输入渠道名称"}]}],expression:"['brand', { rules: [{ required: true, message: '请输入渠道名称' }] }]"}],attrs:{placeholder:"请输入渠道名称"}})],1),n("a-form-item",{attrs:{label:"积分初使值"}},[n("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["score",{rules:[{required:!0,message:"请输入积分初使值"}]}],expression:"['score', { rules: [{ required: true, message: '请输入积分初使值' }] }]"}],staticClass:"width-percent-50",attrs:{min:0,placeholder:"0"}})],1)],1)],1)],1)},i=[],r=(n("b0c0"),n("d3b7"),n("5530")),o=n("2af9"),s=n("6dfa"),c=n("2ef0"),l={components:{STable:o["p"],STableText:o["r"]},data:function(){return{origin:window.location.origin,confirmLoading:!1,channel:{title:"",visible:!1,form:null,status:""},columns:[{title:"ID",dataIndex:"id",width:100},{title:"渠道名称",dataIndex:"brand"},{title:"新增会员",dataIndex:"people"},{title:"积分初使值",dataIndex:"score"},{title:"订单总数",dataIndex:"orderNumber"},{title:"总金额",dataIndex:"orderAmount"},{title:"支付订单数",dataIndex:"orderPayNumber"},{title:"支付金额",dataIndex:"orderPayAmount"},{title:"操作",scopedSlots:{customRender:"action"},fixed:"right"}],pagination:{pageSize:10,current:1},loadData:function(e){var t=e.pageNo,n=e.pageSize,a={page:t,limit:n};return Object(s["d"])(a).then((function(e){var a=e.data,i=a.list,r=a.totalCount;return{pageNo:t,pageSize:n,data:i,totalCount:r}}))}}},created:function(){},methods:{setChannel:function(e){this.channel=Object.assign(this.channel,e)},handleAdd:function(){this.setChannel({title:"添加渠道",status:"add",form:this.$form.createForm(this),visible:!0})},handleSubAdd:function(){var e=this;this.confirmLoading=!0;var t=this.$refs.table,n=this.$notification.success;this.channel.form.validateFields((function(a,i){if(!a){var o=Object(r["a"])(Object(r["a"])({},i),{},{name:i.brand});Object(s["a"])(o).then((function(a){n({message:"成功",description:"添加成功"}),t.refresh(),e.setChannel({visible:!1})}))}setTimeout((function(){e.confirmLoading=!1}),1e3)}))},handleEdit:function(e){var t=this;this.setChannel({title:"编辑 [ ".concat(e.name," ] "),status:"edit",form:this.$form.createForm(this),visible:!0}),new Promise((function(e){setTimeout(e,0)})).then((function(){t.channel.form.setFieldsValue(Object(c["pick"])(e,["id","brand","score"]))}))},handleSubEdit:function(){var e=this;this.confirmLoading=!0;var t=this.$refs.table,n=this.$notification.success;this.channel.form.validateFields((function(a,i){if(!a){var o=Object(r["a"])(Object(r["a"])({},i),{},{name:i.brand});Object(s["e"])(o).then((function(a){n({message:"成功",description:"编辑成功"}),t.refresh(),e.setChannel({visible:!1})}))}setTimeout((function(){e.confirmLoading=!1}),1e3)}))},handleDel:function(e){var t=this.$refs.table,n=this.$notification.success;this.$confirm({title:"警告",content:"是否删除[ ".concat(e.name," ]"),onOk:function(){Object(s["b"])(e.id).then((function(e){n({message:"成功",description:"删除成功"}),t.refresh()}))}})}}},d=l,u=n("2877"),f=Object(u["a"])(d,a,i,!1,null,null,null);t["default"]=f.exports}}]);