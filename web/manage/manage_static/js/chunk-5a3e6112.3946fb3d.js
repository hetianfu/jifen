(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5a3e6112"],{"0fcf":function(t,e,a){"use strict";a("67627")},67627:function(t,e,a){},ff43:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("page-view",{attrs:{title:"商品规格"}},[a("div",[a("a-card",[a("a-button",{staticClass:"margin-bottom-16",attrs:{type:"primary"},on:{click:t.addSpecHandle}},[a("a-icon",{attrs:{type:"plus"}}),t._v("添加规格模板")],1),a("s-table",{ref:"table",staticClass:"order-table",attrs:{rowKey:function(t,e){return e},columns:t.columns,data:t.loadData,pagination:t.pagination},scopedSlots:t._u([{key:"id",fn:function(e,i){return[a("a-popover",{attrs:{placement:"topLeft"}},[a("template",{slot:"content"},[t._v(t._s(i.id))]),a("span",[t._v(t._s(t._f("textOverflowEllipsis")(i.id,0,8)))])],2)]}},{key:"specTagDetail",fn:function(e,i){return[a("a-popover",{attrs:{placement:"topLeft"}},[a("template",{slot:"content"},[t._v(t._s(i.specTagDetail))]),a("span",[t._v(t._s(t._f("textOverflowEllipsis")(i.specTagDetail,0,15)))])],2)]}},{key:"action",fn:function(e,i){return[a("a",{on:{click:function(e){return t.editSpecTmpHandle(i)}}},[t._v("编辑")]),a("a-divider",{attrs:{type:"vertical"}}),a("a",{staticClass:"del_color",on:{click:function(e){return t.delSpecTmpHandle(i)}}},[t._v("删除")])]}}])})],1),a("div",[a("a-modal",{attrs:{title:"添加规格模板",width:"800px",footer:null},model:{value:t.addSpecMal,callback:function(e){t.addSpecMal=e},expression:"addSpecMal"}},[a("a-form",{staticClass:"addSpecClass",attrs:{form:t.form,"label-col":{span:5},"wrapper-col":{span:18}},on:{submit:t.handleAddSpec}},[a("a-form-item",{attrs:{label:"模板名称"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请输入模板名称"}]}],expression:"['name', { rules: [{ required: true, message: '请输入模板名称' }] }]"}],attrs:{placeholder:"请输入模板名称"}})],1),t._l(t.specList,(function(e,i){return a("a-form-item",{key:i,attrs:{label:"规格"+Number(i+1)}},[a("div",[a("div",[a("a-tag",{key:i,staticClass:"headerTag",attrs:{closable:""},on:{close:function(a){return t.handleCloseAddParent(e,i,a)}}},[t._v(t._s(e.name))]),a("div",[t._l(e.value,(function(e,i){return a("a-tag",{key:i,staticClass:"footerTag",attrs:{closable:""},on:{close:function(e){return t.handleClose(i,t.k,e)}}},[t._v(t._s(e))])})),e.inputVisible?a("a-input",{ref:"input",refInFor:!0,style:{width:"78px"},attrs:{type:"text",value:t.inputValue},on:{change:t.handleInputChange,blur:function(a){return t.handleInputConfirm(e,i)}}}):a("a-tag",{staticClass:"footerTag",staticStyle:{background:"#fff",borderStyle:"dashed"},on:{click:function(a){return t.showInput(e,i)}}},[a("a-icon",{attrs:{type:"plus"}}),t._v(" 添加 ")],1)],2)],1)])])})),t.inlineForm?a("a-form",{staticClass:"text-align-center",attrs:{layout:"inline",form:t.specForm},on:{submit:t.handleSpecForm}},[a("a-form-item",{attrs:{label:"规格"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请输入规格"}]}],expression:"['name',{ rules: [{ required: true, message: '请输入规格' }] },]"}],attrs:{placeholder:"请输入规格"}})],1),a("a-form-item",{attrs:{label:"规格值"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["value",{rules:[{required:!0,message:"请输入规格值"}]}],expression:"['value',{ rules: [{ required: true, message: '请输入规格值' }] }, ]"}],attrs:{placeholder:"请输入规格值"}})],1),a("a-form-item",[a("a-button",{attrs:{type:"primary","html-type":"submit"}},[t._v("添加")]),a("a-button",{staticClass:"margin-left-10",attrs:{type:"primary"}},[t._v("取消")])],1)],1):t._e(),a("a-form-item",[t.inlineForm?t._e():a("a-button",{attrs:{type:"primary"},on:{click:t.inlineFormHandle}},[t._v(" 添加规格 ")])],1),a("a-form-item",{staticStyle:{"text-align":"center"},attrs:{"wrapper-col":{span:24}}},[a("a-button",{staticStyle:{width:"120px"},attrs:{type:"primary","html-type":"submit"}},[a("a-icon",{attrs:{type:"upload"}}),t._v("提交")],1)],1)],2)],1)],1),a("div",[a("a-modal",{attrs:{title:"编辑商品规格模板",footer:null,width:"800px"},model:{value:t.editSpecMal,callback:function(e){t.editSpecMal=e},expression:"editSpecMal"}},[a("a-form",{staticClass:"addSpecClass",attrs:{form:t.editForm,"label-col":{span:5},"wrapper-col":{span:18}},on:{submit:t.handleEditSpec}},[a("a-form-item",{attrs:{label:"模板名称"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请输入模板名称"}]}],expression:"['name', { rules: [{ required: true, message: '请输入模板名称' }] }]"}],attrs:{placeholder:"请输入模板名称"}})],1),t._l(t.editList,(function(e,i){return a("a-form-item",{key:i,attrs:{label:"规格"+Number(i+1)}},[a("div",[a("div",[a("a-tag",{key:i,staticClass:"headerTag",attrs:{closable:""},on:{close:function(a){return t.handleCloseParent(e,i,a)}}},[t._v(t._s(e.name))]),a("div",[t._l(e.value,(function(e,n){return a("a-tag",{key:n,staticClass:"footerTag",attrs:{closable:""},on:{close:function(e){return t.handleCloseValue(i,n,e)}}},[t._v(t._s(e))])})),e.inputVisible?a("a-input",{ref:"editInput",refInFor:!0,style:{width:"78px"},attrs:{type:"text",value:t.inputEditValue},on:{change:t.handleInputEditChange,blur:function(a){return t.handleInputEditConfirm(e,i)}}}):a("a-tag",{staticClass:"footerTag",staticStyle:{background:"#fff",borderStyle:"dashed"},on:{click:function(a){return t.showEditInput(e,i)}}},[a("a-icon",{attrs:{type:"plus"}}),t._v(" 添加 ")],1)],2)],1)])])})),t.inlineEditForm?a("a-form",{staticClass:"text-align-center",attrs:{layout:"inline",form:t.specEditForm},on:{submit:t.handleSpecEditForm}},[a("a-form-item",{attrs:{label:"规格"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请输入规格"}]}],expression:"['name',{ rules: [{ required: true, message: '请输入规格' }] },]"}],attrs:{placeholder:"请输入规格"}})],1),a("a-form-item",{attrs:{label:"规格值"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["value",{rules:[{required:!0,message:"请输入规格值"}]}],expression:"[\n                  'value',\n                  { rules: [{ required: true, message: '请输入规格值' }] },\n                ]"}],attrs:{placeholder:"请输入规格值"}})],1),a("a-form-item",[a("a-button",{attrs:{type:"primary","html-type":"submit"}},[t._v("添加")]),a("a-button",{staticClass:"margin-left-10",attrs:{type:"primary"}},[t._v("取消")])],1)],1):t._e(),a("a-form-item",[t.inlineEditForm?t._e():a("a-button",{attrs:{type:"primary"},on:{click:t.inlineFormEditHandle}},[t._v(" 添加规格 ")])],1),a("a-form-item",{staticStyle:{"text-align":"center"},attrs:{"wrapper-col":{span:24}}},[a("a-button",{staticStyle:{width:"120px"},attrs:{type:"primary","html-type":"submit"}},[a("a-icon",{attrs:{type:"upload"}}),t._v("提交")],1)],1)],2)],1)],1)],1)])},n=[],s=(a("d81d"),a("a434"),a("b0c0"),a("d3b7"),a("ac1f"),a("25f0"),a("1276"),a("498a"),a("5530")),r=a("88bc"),l=a.n(r),o=a("4c79"),c=a("2af9"),u=a("c8c3"),d={components:{STable:c["p"],PageView:u["a"]},data:function(){return{editSpecMal:!1,inputValue:"",inputEditValue:"",inlineForm:!1,inlineEditForm:!1,specList:[],editList:[],specData:"",specForm:null,specEditForm:null,editForm:null,addSpecMal:!1,form:null,tags:[],editSpecId:"",columns:[{title:"ID",dataIndex:"id",scopedSlots:{customRender:"id"}},{title:"规格名称",dataIndex:"name",scopedSlots:{customRender:"name"}},{title:"商品属性",dataIndex:"specTag",scopedSlots:{customRender:"specTag"}},{title:"规格详情",dataIndex:"specTagDetail",scopedSlots:{customRender:"specTagDetail"}},{title:"操作",scopedSlots:{customRender:"action"}}],pagination:{pageSize:10,current:1},loadData:function(t){var e=t.pageNo,a=t.pageSize,i={page:e,limit:a};return Object(o["n"])(i).then((function(t){var i=t.data,n=i.list,s=i.totalCount;return{pageNo:e,pageSize:a,data:n,totalCount:s}}))}}},created:function(){},methods:{handleCloseParent:function(t,e,a){a.preventDefault(),this.editList.splice(e,1)},handleCloseAddParent:function(t,e,a){a.preventDefault(),this.specList.splice(e,1)},handleCloseValue:function(t,e,a){a.preventDefault(),this.editList[t].value.splice(e,1)},handleClose:function(t,e,a){a.preventDefault(),this.specList[t].value.splice(e,1)},handleInputChange:function(t){this.inputValue=t.target.value},handleInputEditChange:function(t){t.target.value&&(this.inputEditValue=t.target.value)},handleInputConfirm:function(t,e){""!==this.inputValue.trim()&&this.specList[e].value.push(this.inputValue),Object.assign(t.inputVisible=!1,this.inputValue="",this.$set(this.specList,e,t))},handleInputEditConfirm:function(t,e){""!==this.inputEditValue.trim()&&this.editList[e].value.push(this.inputEditValue),Object.assign(t.inputVisible=!1,this.inputEditValue="",this.$set(this.editList,e,t))},showInput:function(t,e){t.inputVisible=!0,this.$set(this.specList,e,t)},showEditInput:function(t,e){t.inputVisible=!0,this.$set(this.editList,e,t)},addSpecHandle:function(){this.specList=[],this.form=this.$form.createForm(this),this.specForm=this.$form.createForm(this),this.addSpecMal=!0},editSpecTmpHandle:function(t){var e=this;this.editSpecId=t.id,this.editForm=this.$form.createForm(this),this.specEditForm=this.$form.createForm(this),Object(o["l"])(t.id).then((function(t){e.editList=t.data.specList;for(var a=0;a<e.editList.length;a++)e.editList[a].value=e.editList[a].value.split(",")})),new Promise((function(t){setTimeout(t,0)})).then((function(){e.editForm.setFieldsValue(l()(t,["name"]))})),this.editSpecMal=!0},handleAddSpec:function(t){var e=this;t.preventDefault();for(var i=this.specList,n=a("2ef0"),r=n.cloneDeep(i),l=0;l<i.length;l++)r[l].value=r[l].value.toString();var c=this.$refs.table,u=this.$notification.success;this.form.validateFields((function(t,a){if(r.length<1)e.$message.error("模板规格不能少于1条");else{var i=r;if(e.specData=Object(s["a"])(Object(s["a"])({},a),{},{specList:i}),!t){var n=e.specData;Object(o["b"])(n).then((function(t){e.specList=[],u({message:"成功",description:"添加成功"}),c.refresh(!0),e.addSpecMal=!1}))}}}))},handleEditSpec:function(t){var e=this;t.preventDefault();for(var i=this.editList,n=this.editSpecId,r=a("2ef0"),l=r.cloneDeep(i),c=n,u=0;u<l.length;u++)l[u].value=l[u].value.toString();var d=this.$refs.table,p=this.$notification.success;this.editForm.validateFields((function(t,a){if(!t){var i=l,n=Object(s["a"])(Object(s["a"])({},a),{},{specList:i,id:c});Object(o["t"])(n).then((function(t){p({message:"成功",description:"修改成功"}),d.refresh(!0),e.editSpecMal=!1}))}}))},handleSpecForm:function(t){var e=this;t.preventDefault(),this.specForm.validateFields((function(t,a){var i=[a];i.map((function(i){if(void 0!==i.name&&void 0!==i.value){a.value=[a.value],e.specList.push(a);for(var n=0;n<e.specList.length;n++)e.specList[n].inputVisible=!1;t||(e.inlineForm=!e.inlineForm)}}))}))},handleSpecEditForm:function(t){var e=this;t.preventDefault(),this.specEditForm.validateFields((function(t,a){var i=[a];i.map((function(i){if(void 0!==i.name&&void 0!==i.value){a.value=[a.value],e.editList.push(a);for(var n=0;n<e.editList.length;n++)e.editList[n].inputVisible=!1;t||(e.inlineEditForm=!e.inlineEditForm)}}))}))},inlineFormHandle:function(){this.inlineForm=!this.inlineForm},inlineFormEditHandle:function(){this.inlineEditForm=!this.inlineEditForm},delSpecTmpHandle:function(t){var e=this.$refs.table,a=this.$notification.success;this.$confirm({title:"警告",content:"是否删除[ ".concat(t.name," ]模板"),onOk:function(){Object(o["g"])(t.id).then((function(t){a({message:"成功",description:"删除成功"}),e.refresh(!0)}))}})}}},p=d,m=(a("0fcf"),a("2877")),f=Object(m["a"])(p,i,n,!1,null,"55a104bc",null);e["default"]=f.exports}}]);