(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-40f796c5"],{"0f53":function(e,t,a){"use strict";a("126c")},"126c":function(e,t,a){},"587eb":function(e,t,a){},"64cb":function(e,t,a){"use strict";a("ab35")},7488:function(e,t,a){"use strict";a.d(t,"d",(function(){return s})),a.d(t,"a",(function(){return n})),a.d(t,"e",(function(){return l})),a.d(t,"b",(function(){return c})),a.d(t,"c",(function(){return d}));a("99af");var o=a("365c"),r=a("b775"),i=o["b"].shopMag;function s(e){return Object(r["b"])({url:i.getShopPage,method:"get",params:e})}function n(e){return Object(r["b"])({url:i.addshop,method:"post",data:e})}function l(e){return Object(r["b"])({url:i.updateShopById,method:"patch",data:e})}function c(e){return Object(r["b"])({url:"".concat(i.deleteShopById).concat(e),method:"delete"})}function d(e){return Object(r["b"])({url:i.getShopById+e,method:"get"})}},ab35:function(e,t,a){},bc17:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=this,a=t.$createElement,o=t._self._c||a;return o("div",{staticClass:"page-header-index-wide"},[o("a-card",{style:{height:"100%"},attrs:{bordered:!1,bodyStyle:{padding:"16px 0",height:"100%"}}},[o("div",{staticClass:"account-settings-info-main",class:t.device},[o("div",{staticClass:"account-settings-info-left"},[o("a-menu",{style:{border:"0",width:"mobile"==t.device?"560px":"auto"},attrs:{mode:"mobile"==t.device?"horizontal":"inline",multiple:!1,type:"inner"},on:{click:t.onOpenChange},model:{value:t.selectedKeys,callback:function(e){t.selectedKeys=e},expression:"selectedKeys"}},[o("a-menu-item",{key:"BasicInfo"},[t._v("基本信息")]),o("a-menu-item",{key:"StoreImg"},[t._v("门店图片")])],1)],1),o("div",{staticClass:"account-settings-info-right"},[o("div",{staticClass:"account-settings-info-title"},[o("span",[t._v(t._s(t.textMap[t.currentComponet]))])]),o("a-form",{directives:[{name:"show",rawName:"v-show",value:"BasicInfo"===t.currentComponet,expression:"currentComponet === 'BasicInfo'"}],attrs:{form:t.basicForm}},[o("basic-info",{attrs:{form:t.basicForm,info:t.info}})],1),o("a-form",{directives:[{name:"show",rawName:"v-show",value:"StoreImg"===t.currentComponet,expression:"currentComponet === 'StoreImg'"}],attrs:{form:t.imgForm}},[o("store-img",{attrs:{form:t.imgForm,info:t.info,temp:t.temp}})],1)],1)])]),o("footer-tool-bar",{staticClass:"display-flex justify-content-center",style:{width:t.isSideMenu()&&t.isDesktop()?"calc(100% - "+(t.sidebarOpened?200:80)+"px)":"100%"}},[o("a-button",{attrs:{type:"primary"},on:{click:t.handleSubmit}},[t._v("修改")]),o("a-button",{staticClass:"margin-left-10",on:{click:function(){return e.$router.go(-1)}}},[t._v("取消")])],1)],1)},r=[],i=(a("d81d"),a("b64b"),a("d3b7"),a("ade3")),s=a("5a70"),n=a("88bc"),l=a.n(n),c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"basic-info"},[a("a-row",{attrs:{gutter:16}},[a("a-col",{attrs:{md:24,lg:18}},[a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"门店名称"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["shopName",{rules:[{required:!0,message:"请输入门店名称"}]}],expression:"['shopName', { rules: [{ required: true, message: '请输入门店名称' }] }]"}],attrs:{placeholder:"门店名称"}})],1),a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:{span:10},label:"联系电话"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["phone",{rules:[{required:!0,message:"请输入联系电话"}]}],expression:"['phone', { rules: [{ required: true, message: '请输入联系电话' }] }]"}],attrs:{placeholder:"联系电话"}})],1),a("a-form-item",{staticClass:"padding-bottom-0 margin-bottom-0",attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"店铺经度"}},[a("a-input-group",{attrs:{compact:""}},[a("a-form-item",{staticClass:"form-item-lat"},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["lat"],expression:"['lat']"}],staticClass:"shop-latitude border-trr-0 border-brr-0",attrs:{placeholder:"经度"}})],1),a("a-form-item",{staticClass:"form-item-lng"},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["lng"],expression:"['lng']"}],staticClass:"shop-longitude border-radius-0",attrs:{placeholder:"纬度"}})],1),a("a-form-item",[a("a-button",{staticClass:"border-tlr-0 border-blr-0",on:{click:e.handleSelectCoordinate}},[e._v("选择坐标")])],1)],1)],1),a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"门店详细地址"}},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["address"],expression:"['address']"}],attrs:{placeholder:"门店详细地址","allow-clear":""}})],1),a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:{span:6},label:"营业时间",extra:"格式：如09:00:00-16:30:00"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["businessTime"],expression:"['businessTime']"}],attrs:{placeholder:"营业时间"}})],1),a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"店铺简介"}},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["detail"],expression:"['detail']"}],attrs:{placeholder:"店铺简介","allow-clear":""}})],1),a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"状态"}},[a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["status",{initialValue:1}],expression:"['status', { initialValue: 1 }]"}]},[a("a-radio",{attrs:{value:1}},[e._v("正式营业")]),a("a-radio",{attrs:{value:0}},[e._v("未上线")]),a("a-radio",{attrs:{value:-1}},[e._v("已关闭")])],1)],1)],1)],1),a("a-modal",{attrs:{maskClosable:!1,title:"请选择地点",width:"800px",centered:!0},on:{ok:e.confirmLocate},model:{value:e.locate.visible,callback:function(t){e.$set(e.locate,"visible",t)},expression:"locate.visible"}},[a("div",{staticStyle:{width:"100%",height:"650px"},attrs:{id:"map-container"}})])],1)},d=[],m=(a("99af"),a("b0c0"),a("ac1f"),a("5319"),a("ed08")),u={name:"BasicInfo",components:{},props:{info:{type:Object,required:function(){}}},data:function(e){var t=this.$route.params.id;return{id:t,labelCol:{span:5},wrapperCol:{span:18},locate:{visible:!1}}},created:function(){this.getInfo()},methods:{getInfo:function(){var e=this,t=this.$attrs.form.setFieldsValue;new Promise((function(e){setTimeout(e,0)})).then((function(){t(l()(e.info,["shopName","phone","lat","lng","address","businessTime","detail","status"]))}))},setLocate:function(e){this.locate=Object.assign(this.locate,e)},handleSelectCoordinate:function(){var e=this,t=this.$attrs.form.getFieldValue,a=t("lat"),o=t("lng");this.setLocate({visible:!0}),this.$nextTick((function(){e.initMap(a,o)}))},confirmLocate:function(){var e=this.locate,t=this.$attrs.form.setFieldsValue,a=l()(e,["lat","lng","address"]);t(a),this.setLocate({visible:!1})},initMap:function(e,t){var a=this,o=window.qq,r=new o.maps.LatLng(e,t),i=new o.maps.Map(document.getElementById("map-container"),{zoom:16,mapTypeId:o.maps.MapTypeId.ROADMAP}),s=function(e,t,o){a.setLocate({lat:String(e).replace(/^(.*\..{5}).*$/,"$1"),lng:String(t).replace(/^(.*\..{5}).*$/,"$1"),address:o})},n=new o.maps.CityService({complete:function(e){var t=e.detail,a=t.latLng,o=t.name;s(a.lat,a.lng,o),i.setCenter(a),l.setPosition(e.detail.latLng)}}),l=new o.maps.Marker({map:i,animation:o.maps.MarkerAnimation.BOUNCE}),c=function(e){l.setPosition(e.latLng)};e||t?(i.setCenter(r),l.setPosition(r)):n.searchLocalCity(),o.maps.event.addListener(i,"click",(function(e){var t=e.latLng,a=t.lat,o=t.lng;Object(m["g"])("location=".concat(a,",").concat(o),(function(e){var t=e.result.address;return s(a,o,t)}))})),o.maps.event.addListener(i,"click",c)}}},p=u,f=(a("f2e9"),a("2877")),g=Object(f["a"])(p,c,d,!1,null,"42f67f0a",null),h=g.exports,b=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-row",{attrs:{gutter:16}},[a("a-col",{attrs:{md:24,lg:18}},[a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"门店Logo"}},[a("upload-img",{directives:[{name:"decorator",rawName:"v-decorator",value:["logo",{rules:[{required:!0,message:"请上传门店Logo"}]}],expression:"['logo', { rules: [{ required: true, message: '请上传门店Logo' }] }]"}]})],1),a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"门店照"}},[a("upload-img",{directives:[{name:"decorator",rawName:"v-decorator",value:["frontImg",{rules:[{required:!0,message:"请上传门店照"}]}],expression:"['frontImg', { rules: [{ required: true, message: '请上传门店照' }] }]"}]})],1),a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"门店照"}},[a("upload-img",{directives:[{name:"decorator",rawName:"v-decorator",value:["backImg"],expression:"['backImg']"}]})],1)],1)],1)],1)},v=[],C=a("365c"),w=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-upload",{attrs:{action:e.action,headers:e.headers,"show-upload-list":!1,beforeUpload:e.onBeforeUpload,"list-type":"picture-card"},on:{change:e.onChangeUpload}},[a("div",[e.image&&"loading"!==e.image?a("img",{staticStyle:{width:"70px",height:"70px"},attrs:{src:e.image,alt:"avatar"}}):a("div",[a("a-icon",{attrs:{type:e.image?"loading":"plus"}}),a("div",{staticClass:"ant-upload-text"},[e._v(e._s(e.image?"文件上传中":"上传"))])],1)])])],1)},I=[],y={props:{value:{},action:{type:String,required:!0},showUploadList:{type:Boolean,default:!0}},model:{prop:"value",event:"change"},watch:{value:function(e){this.image=e}},data:function(){var e=Object(m["i"])();return{headers:e,image:""}},methods:{onBeforeUpload:function(e){var t="image/jpeg"===e.type||"image/png"===e.type;t||this.$message.error("你只能上传 JPG或PNG 文件！");var a=e.size/1024/1024<2;return a||this.$message.error("图像必须小于2MB！"),t&&a},onChangeUpload:function(e){var t=e.file;e.fileList;if("uploading"===t.status&&(this.image="loading"),"done"===t.status){var a=t.response.data;this.image=a.accessUrl,this.$emit("change",a.accessUrl)}}}},x=y,k=Object(f["a"])(x,w,I,!1,null,null,null),F=k.exports,O={name:"ProductInfo",components:{UploadImage:F},data:function(){var e=Object(m["i"])();return{labelCol:{span:5},wrapperCol:{span:19},headers:e,action:C["b"].uploadImgs.addShopImage}},props:{temp:{type:Object,required:function(){}}},methods:{handleChangeLogo:function(e){var t=this.$attrs.form.setFieldsValue;t({logo:e})},handleChangeFrontImg:function(e){var t=this.$attrs.form.setFieldsValue;t({frontImg:e})},handleChangeBackImg:function(e){var t=this.$attrs.form.setFieldsValue;t({backImg:e})}}},S=O,$=Object(f["a"])(S,b,v,!1,null,"4ed92570",null),j=$.exports,B=a("7488"),L=a("ac0d"),N={components:{FooterToolBar:s["a"],basicInfo:h,storeImg:j},mixins:[L["b"],L["c"]],data:function(){var e=this.$route.params.id;return{id:e,currentComponet:"",selectedKeys:["BasicInfo"],textMap:{BasicInfo:"基本信息",StoreImg:"门店图片"},basicForm:null,imgForm:null,info:{logo:"",frontImg:"",backImg:"",shopName:"",phone:"",lat:"",lng:"",address:"",businessTime:"",detail:"",status:1},temp:{}}},created:function(){this.getShopById(),this.currentComponet="BasicInfo",this.createForm()},methods:{getShopById:function(){var e=this;Object(B["c"])(this.id).then((function(t){e.setInfo(t.data),new Promise((function(e){setTimeout(e,0)})).then((function(){e.basicForm.setFieldsValue(l()(e.info,["shopName","phone","lat","lng","address","businessTime","detail","status"])),e.temp={logo:e.info.logo,frontImg:e.info.frontImg,backImg:e.info.backImg},e.imgForm.setFieldsValue(l()(e.info,["logo","frontImg","backImg"]))}))}))},onOpenChange:function(e){var t=e.key;this.currentComponet=t},setInfo:function(e){this.info=Object.assign(this.info,e)},createForm:function(){var e=this;this.basicForm=this.$form.createForm(this,{onFieldsChange:function(t,a){Object.keys(a).map((function(t){var o=a[t]["value"],r=Object(i["a"])({},t,o);e.setInfo(r)}))}}),this.imgForm=this.$form.createForm(this,{onFieldsChange:function(t,a){Object.keys(a).map((function(t){var o=a[t]["value"],r=Object(i["a"])({},t,o);e.setInfo(r)}))}})},handleSubmit:function(){var e=this,t=this.basicForm,a=this.imgForm,o=this.$notification.success,r=this.info,i=!1;t.validateFields((function(t,a){t&&(e.selectedKeys=["BasicInfo"],e.currentComponet="BasicInfo",i=!0)})),i||(a.validateFields((function(t,a){t&&(e.selectedKeys=["StoreImg"],e.currentComponet="StoreImg",i=!0)})),i||Object(B["e"])(r).then((function(t){o({message:"成功",description:"编辑成功"}),e.$router.push({name:"StoreManage"})})))}}},_=N,q=(a("64cb"),a("0f53"),Object(f["a"])(_,o,r,!1,null,"b50967da",null));t["default"]=q.exports},f2e9:function(e,t,a){"use strict";a("587eb")}}]);